(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{242:function(e,n,s){"use strict";var i=s(378),a=s(0),r=s.n(a),o=[t("mediadc","Photos"),t("mediadc","Videos"),t("mediadc","Photos and Videos")];n.a={methods:{formatBytes:i.a,parseUnixTimestamp:function(t){return r.a.unix(Number(t)).format("YYYY-MM-DD HH:mm:ss")},getStatusBadge:function(t){return null==t?"":""!==t.errors?"error":0===Number(t.py_pid)&&0===Number(t.finished_time)&&Number(t.updated_time)>0&&Number(t.files_scanned)>0?"terminated":Number(t.py_pid)>0?r()().unix()>Number(t.updated_time)+24?"error":"running":Number(t.finished_time)>0&&0===Number(t.py_pid)?"finished":"pending"},parseTargetMtype:function(t){if(t)try{return o[Number(JSON.parse(t.collector_settings).target_mtype)]}catch(t){return""}return""}}}},378:function(t,e,n){"use strict";n.d(e,"d",(function(){return l})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return u}));var s=n(12),i=n(21),a=n(22),r=n.n(a);function o(t,e,n,s,i,a,r){try{var o=t[a](r),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(s,i)}
/**
 * @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>
 * @copyright 2021 Alexander Piskun <bigcat88@icloud.com>
 *
 * @author Andrey Borysenko <andrey18106x@gmail.com>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var c=function(t){return window.DOMParser?(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("oc:fileid")[0].innerHTML:-1},d=function(t){return window.DOMParser?(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:getcontenttype")[0].innerHTML:null},l=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(Object(s.generateRemoteUrl)("dav"),"/files/").concat(Object(i.getCurrentUser)().uid).concat(e),t.next=3,r()({method:"PROPFIND",url:n,data:'<?xml version="1.0"?>\n\t<d:propfind xmlns:d="DAV:" xmlns:oc="http://owncloud.org/ns"\n\t\t\t\txmlns:nc="http://nextcloud.org/ns"\n\t\t\t\txmlns:ocs="http://open-collaboration-services.org/ns">\n\t\t<d:prop>\n\t\t\t<oc:fileid />\n\t\t\t<d:getcontenttype />\n\t\t</d:prop>\n\t</d:propfind>',headers:{details:!0,depth:0}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){o(a,s,i,r,c,"next",t)}function c(t){o(a,s,i,r,c,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}(),u=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===t)return"0 B";var n=1024,s=e<0?0:e,i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(t)/Math.log(n));return parseFloat((t/Math.pow(n,a)).toFixed(s))+" "+i[a]}},413:function(t,e,n){var s={"./af":243,"./af.js":243,"./ar":244,"./ar-dz":245,"./ar-dz.js":245,"./ar-kw":246,"./ar-kw.js":246,"./ar-ly":247,"./ar-ly.js":247,"./ar-ma":248,"./ar-ma.js":248,"./ar-sa":249,"./ar-sa.js":249,"./ar-tn":250,"./ar-tn.js":250,"./ar.js":244,"./az":251,"./az.js":251,"./be":252,"./be.js":252,"./bg":253,"./bg.js":253,"./bm":254,"./bm.js":254,"./bn":255,"./bn-bd":256,"./bn-bd.js":256,"./bn.js":255,"./bo":257,"./bo.js":257,"./br":258,"./br.js":258,"./bs":259,"./bs.js":259,"./ca":260,"./ca.js":260,"./cs":261,"./cs.js":261,"./cv":262,"./cv.js":262,"./cy":263,"./cy.js":263,"./da":264,"./da.js":264,"./de":265,"./de-at":266,"./de-at.js":266,"./de-ch":267,"./de-ch.js":267,"./de.js":265,"./dv":268,"./dv.js":268,"./el":269,"./el.js":269,"./en-au":270,"./en-au.js":270,"./en-ca":271,"./en-ca.js":271,"./en-gb":272,"./en-gb.js":272,"./en-ie":273,"./en-ie.js":273,"./en-il":274,"./en-il.js":274,"./en-in":275,"./en-in.js":275,"./en-nz":276,"./en-nz.js":276,"./en-sg":277,"./en-sg.js":277,"./eo":278,"./eo.js":278,"./es":279,"./es-do":280,"./es-do.js":280,"./es-mx":281,"./es-mx.js":281,"./es-us":282,"./es-us.js":282,"./es.js":279,"./et":283,"./et.js":283,"./eu":284,"./eu.js":284,"./fa":285,"./fa.js":285,"./fi":286,"./fi.js":286,"./fil":287,"./fil.js":287,"./fo":288,"./fo.js":288,"./fr":289,"./fr-ca":290,"./fr-ca.js":290,"./fr-ch":291,"./fr-ch.js":291,"./fr.js":289,"./fy":292,"./fy.js":292,"./ga":293,"./ga.js":293,"./gd":294,"./gd.js":294,"./gl":295,"./gl.js":295,"./gom-deva":296,"./gom-deva.js":296,"./gom-latn":297,"./gom-latn.js":297,"./gu":298,"./gu.js":298,"./he":299,"./he.js":299,"./hi":300,"./hi.js":300,"./hr":301,"./hr.js":301,"./hu":302,"./hu.js":302,"./hy-am":303,"./hy-am.js":303,"./id":304,"./id.js":304,"./is":305,"./is.js":305,"./it":306,"./it-ch":307,"./it-ch.js":307,"./it.js":306,"./ja":308,"./ja.js":308,"./jv":309,"./jv.js":309,"./ka":310,"./ka.js":310,"./kk":311,"./kk.js":311,"./km":312,"./km.js":312,"./kn":313,"./kn.js":313,"./ko":314,"./ko.js":314,"./ku":315,"./ku.js":315,"./ky":316,"./ky.js":316,"./lb":317,"./lb.js":317,"./lo":318,"./lo.js":318,"./lt":319,"./lt.js":319,"./lv":320,"./lv.js":320,"./me":321,"./me.js":321,"./mi":322,"./mi.js":322,"./mk":323,"./mk.js":323,"./ml":324,"./ml.js":324,"./mn":325,"./mn.js":325,"./mr":326,"./mr.js":326,"./ms":327,"./ms-my":328,"./ms-my.js":328,"./ms.js":327,"./mt":329,"./mt.js":329,"./my":330,"./my.js":330,"./nb":331,"./nb.js":331,"./ne":332,"./ne.js":332,"./nl":333,"./nl-be":334,"./nl-be.js":334,"./nl.js":333,"./nn":335,"./nn.js":335,"./oc-lnc":336,"./oc-lnc.js":336,"./pa-in":337,"./pa-in.js":337,"./pl":338,"./pl.js":338,"./pt":339,"./pt-br":340,"./pt-br.js":340,"./pt.js":339,"./ro":341,"./ro.js":341,"./ru":342,"./ru.js":342,"./sd":343,"./sd.js":343,"./se":344,"./se.js":344,"./si":345,"./si.js":345,"./sk":346,"./sk.js":346,"./sl":347,"./sl.js":347,"./sq":348,"./sq.js":348,"./sr":349,"./sr-cyrl":350,"./sr-cyrl.js":350,"./sr.js":349,"./ss":351,"./ss.js":351,"./sv":352,"./sv.js":352,"./sw":353,"./sw.js":353,"./ta":354,"./ta.js":354,"./te":355,"./te.js":355,"./tet":356,"./tet.js":356,"./tg":357,"./tg.js":357,"./th":358,"./th.js":358,"./tk":359,"./tk.js":359,"./tl-ph":360,"./tl-ph.js":360,"./tlh":361,"./tlh.js":361,"./tr":362,"./tr.js":362,"./tzl":363,"./tzl.js":363,"./tzm":364,"./tzm-latn":365,"./tzm-latn.js":365,"./tzm.js":364,"./ug-cn":366,"./ug-cn.js":366,"./uk":367,"./uk.js":367,"./ur":368,"./ur.js":368,"./uz":369,"./uz-latn":370,"./uz-latn.js":370,"./uz.js":369,"./vi":371,"./vi.js":371,"./x-pseudo":372,"./x-pseudo.js":372,"./yo":373,"./yo.js":373,"./zh-cn":374,"./zh-cn.js":374,"./zh-hk":375,"./zh-hk.js":375,"./zh-mo":376,"./zh-mo.js":376,"./zh-tw":377,"./zh-tw.js":377};function i(t){var e=a(t);return n(e)}function a(t){if(!n.o(s,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return s[t]}i.keys=function(){return Object.keys(s)},i.resolve=a,t.exports=i,i.id=413},454:function(t,e,n){"use strict";var s=n(66),i=n.n(s)()(!0);i.push([t.i,"\n.new-task-block[data-v-1cc9e28c] {\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tbox-shadow: 0 0 4px 0 rgba(0, 0, 0, .05);\n\tpadding: 20px;\n\tmargin: 10px;\n\twidth: 100%;\n\tmax-width: 600px;\n}\n.selection-container[data-v-1cc9e28c] {\n\twidth: 100%;\n\tdisplay: flex;\n}\n@media (max-width: 767px) {\n.selection-container[data-v-1cc9e28c] {\n\t\tflex-wrap: wrap;\n}\n}\n.block[data-v-1cc9e28c] {\n\twidth: 100%;\n\theight: 100%;\n\tmax-height: 200px;\n\toverflow-y: scroll;\n\tpadding: 10px 15px;\n\tmargin: 5px 10px;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n}\n.block[data-v-1cc9e28c]:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, .05)\n}\n.target-directory[data-v-1cc9e28c], .custom-mask[data-v-1cc9e28c] {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tpadding: 5px 0;\n\tborder-bottom: 1px solid #dadada;\n}\n.delete-button[data-v-1cc9e28c] {\n\tdisplay: inline-flex;\n\twidth: 15px;\n\theight: 15px;\n\tcursor: pointer;\n\tmargin: 0 10px;\n}\nbody.theme--dark .new-task-block[data-v-1cc9e28c], body.theme--dark .block[data-v-1cc9e28c] {\n\tborder-color: #717171;\n}\n","",{version:3,sources:["webpack://src/components/tasks/TasksNew.vue"],names:[],mappings:";AAoVA;CACA,yBAAA;CACA,kBAAA;CACA,wCAAA;CACA,aAAA;CACA,YAAA;CACA,WAAA;CACA,gBAAA;AACA;AAEA;CACA,WAAA;CACA,aAAA;AACA;AAEA;AACA;EACA,eAAA;AACA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,iBAAA;CACA,kBAAA;CACA,kBAAA;CACA,gBAAA;CACA,yBAAA;CACA,kBAAA;AACA;AAEA;CACA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;CACA,cAAA;CACA,gCAAA;AACA;AAEA;CACA,oBAAA;CACA,WAAA;CACA,YAAA;CACA,eAAA;CACA,cAAA;AACA;AAEA;CACA,qBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"new-task-block\">\n\t\t<h2>{{ t('mediadc', 'Create a new Task') }}</h2>\n\t\t<div class=\"selection-container\">\n\t\t\t<div class=\"block target-directories-block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Target directories') }}</h3>\n\t\t\t\t<div v-if=\"targetDirectoriesIds.length > 0\">\n\t\t\t\t\t<div v-for=\"fileid in targetDirectoriesIds\" :key=\"fileid\" class=\"selected-target-directories-list\">\n\t\t\t\t\t\t<div class=\"target-directory\">\n\t\t\t\t\t\t\t<span style=\"overflow-y: scroll;\">{{ targetDirectoriesPaths[fileid] }}</span>\n\t\t\t\t\t\t\t<span class=\"delete-button icon-delete\" @click=\"removeTargetDirectory(fileid)\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not selected') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<br>\n\t\t\t\t<button @click=\"openDirectoriesExplorer\">\n\t\t\t\t\t<span class=\"icon-add\" />\n\t\t\t\t\t{{ t('mediadc', 'Select') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Exclude directories') }}</h3>\n\t\t\t\t<div v-if=\"excludeDirectoriesNames.length > 0\">\n\t\t\t\t\t<div v-for=\"dir in excludeDirectoriesNames\" :key=\"dir\" class=\"selected-excluded-directories-list\">\n\t\t\t\t\t\t<div class=\"target-directory\">\n\t\t\t\t\t\t\t<span style=\"overflow-y: scroll;\">{{ dir }}</span>\n\t\t\t\t\t\t\t<span class=\"delete-button icon-delete\" @click=\"removeExcludeDirectory(dir)\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not selected') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"Object.keys(excludeFileIds).length > 0\">\n\t\t\t\t\t<div v-for=\"fileid in excludeFileIds\" :key=\"fileid\">\n\t\t\t\t\t\t<div class=\"target-directory\">\n\t\t\t\t\t\t\t<span style=\"overflow-y: scroll;\">{{ excludeFileIds[fileid] }}</span>\n\t\t\t\t\t\t\t<span class=\"delete-button icon-delete\" @click=\"removeExcludeFileid(fileid)\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<br>\n\t\t\t\t<button @click=\"openExcludeExplorer\">\n\t\t\t\t\t<span class=\"icon-add\" />\n\t\t\t\t\t{{ t('mediadc', 'Select') }}\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class=\"selection-container\">\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3>{{ t('mediadc', 'Custom exclude mask') }}</h3>\n\t\t\t\t<div v-if=\"customExcludeList.length > 0\" class=\"custom-masks-list\">\n\t\t\t\t\t<div v-for=\"(mask, index) in customExcludeList\" :key=\"index\" class=\"custom-mask\">\n\t\t\t\t\t\t<span>{{ mask }}</span>\n\t\t\t\t\t\t<span class=\"icon-delete\" style=\"cursor: pointer;\" @click=\"deleteCustomMask(mask)\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div v-else>\n\t\t\t\t\t<span>{{ t('mediadc', 'Not added') }}</span>\n\t\t\t\t</div>\n\t\t\t\t<div v-if=\"addingCustomMask\" style=\"display: flex; align-items: center;\">\n\t\t\t\t\t<input id=\"custom-exclude-mask\"\n\t\t\t\t\t\tref=\"customExcludeMask\"\n\t\t\t\t\t\tv-model=\"customExcludeMask\"\n\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t@keyup.enter=\"addCustomMask\"\n\t\t\t\t\t\t@keyup.esc=\"cancelAddingCustomMask\">\n\t\t\t\t\t<span class=\"icon-checkmark\" style=\"width: 18px; height: 18px; margin: 0 5px; display: inline-block; cursor: pointer;\" @click=\"addCustomMask\" />\n\t\t\t\t\t<span class=\"icon-close\" style=\"width: 18px; height: 18px; margin: 0 5px; display: inline-block; cursor: pointer;\" @click=\"cancelAddingCustomMask\" />\n\t\t\t\t</div>\n\t\t\t\t<div style=\"display: flex; align-items: center; margin: 20px 0;\">\n\t\t\t\t\t<button @click=\"addNewMask\">\n\t\t\t\t\t\t<span class=\"icon-add\" />\n\t\t\t\t\t\t<span>{{ t('mediadc', 'Add mask') }}</span>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"block\">\n\t\t\t\t<h3 style=\"margin: 5px 0;\">\n\t\t\t\t\t{{ t('mediadc', 'Target Mime Type') }}\n\t\t\t\t</h3>\n\t\t\t\t<select id=\"target_mtype\"\n\t\t\t\t\tv-model=\"targetMimeType\"\n\t\t\t\t\tname=\"target_mtype\">\n\t\t\t\t\t<option :value=\"0\">\n\t\t\t\t\t\t{{ t('mediadc', 'Photos') }}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option :value=\"1\">\n\t\t\t\t\t\t{{ t('mediadc', 'Videos') }}\n\t\t\t\t\t</option>\n\t\t\t\t\t<option :value=\"2\">\n\t\t\t\t\t\t{{ t('mediadc', 'Photos and Videos') }}\n\t\t\t\t\t</option>\n\t\t\t\t</select>\n\t\t\t\t<h3 style=\"margin: 5px 0;\">\n\t\t\t\t\t{{ t('mediadc', 'Similarity threshold') }}\n\t\t\t\t</h3>\n\t\t\t\t<input v-model=\"similarity_threshold\"\n\t\t\t\t\ttype=\"number\"\n\t\t\t\t\tmin=\"50\"\n\t\t\t\t\tmax=\"100\"\n\t\t\t\t\tstyle=\"margin: 0 0 10px;\">\n\t\t\t</div>\n\t\t</div>\n\t\t<button v-if=\"!runningTask\"\n\t\t\tstyle=\"margin: 10px 5px 0\"\n\t\t\t:disabled=\"Object.keys(targetDirectoriesPaths).length === 0\"\n\t\t\t@click=\"runCollectorTask\">\n\t\t\tRun Collector Task\n\t\t</button>\n\t\t<button v-else disabled>\n\t\t\t<span class=\"icon-loading\" />\n\t\t</button>\n\t</div>\n</template>\n\n<script>\nimport { generateUrl } from '@nextcloud/router'\nimport { getFilePickerBuilder, showWarning, showSuccess } from '@nextcloud/dialogs'\nimport axios from '@nextcloud/axios'\nimport { requestFileInfo, getFileId, getContentType } from '../../utils/files'\nimport { mapGetters } from 'vuex'\n\nexport default {\n\tname: 'TasksNew',\n\tdata() {\n\t\treturn {\n\t\t\ttargetDirectoriesPaths: {},\n\t\t\ttargetDirectoriesIds: [],\n\t\t\texcludeDirectoriesNames: [],\n\t\t\texcludeFileIds: {},\n\t\t\ttargetMimeType: 0,\n\t\t\tsimilarity_threshold: 90,\n\t\t\tcustomExcludeList: [],\n\t\t\tcustomExcludeMask: '',\n\t\t\taddingCustomMask: false,\n\t\t\trunningTask: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'settings',\n\t\t\t'settingByName',\n\t\t\t'tasks',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.similarity_threshold = this.settingByName('similarity_threshold') !== undefined\n\t\t\t? this.settingByName('similarity_threshold').value\n\t\t\t: 90\n\t},\n\tmethods: {\n\t\tgetDirectoriesPicker(title) {\n\t\t\treturn getFilePickerBuilder(title)\n\t\t\t\t.setMultiSelect(false)\n\t\t\t\t.addMimeTypeFilter('httpd/unix-directory')\n\t\t\t\t.setModal(true)\n\t\t\t\t.setType(1)\n\t\t\t\t.allowDirectories(true)\n\t\t\t\t.build()\n\t\t},\n\t\tgetFilesPicker(title) {\n\t\t\treturn getFilePickerBuilder(title)\n\t\t\t\t.setMultiSelect(false)\n\t\t\t\t.setModal(true)\n\t\t\t\t.setType(1)\n\t\t\t\t.allowDirectories(true)\n\t\t\t\t.build()\n\t\t},\n\t\topenDirectoriesExplorer() {\n\t\t\tthis.getDirectoriesPicker(t('mediadc', 'Choose target directory')).pick().then(dir => {\n\t\t\t\tif (dir.startsWith('/')) {\n\t\t\t\t\trequestFileInfo(dir).then(res => {\n\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\tif (!(fileid in this.targetDirectoriesPaths)) {\n\t\t\t\t\t\t\t\tthis.targetDirectoriesIds.push(fileid)\n\t\t\t\t\t\t\t\tthis.targetDirectoriesPaths[fileid.toString()] = dir\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowWarning(t('mediadc', 'This directory already selected'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t} else {\n\t\t\t\t\trequestFileInfo('/').then(res => {\n\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\tif (fileid !== -1) {\n\t\t\t\t\t\t\tif (!(fileid in this.targetDirectoriesPaths)) {\n\t\t\t\t\t\t\t\tthis.targetDirectoriesIds.push(fileid)\n\t\t\t\t\t\t\t\tthis.targetDirectoriesPaths[fileid.toString()] = '/'\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tshowWarning(t('mediadc', 'This directory already selected'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\tthis.targetDirectoriesPaths.push('/')\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\topenExcludeExplorer() {\n\t\t\tthis.getDirectoriesPicker(t('mediadc', 'Choose directory to exclude')).pick().then(dir => {\n\t\t\t\tif (this.excludeDirectoriesNames.findIndex(targetDir => targetDir === dir) === -1) {\n\t\t\t\t\tif (dir.startsWith('/')) {\n\t\t\t\t\t\trequestFileInfo(dir).then(res => {\n\t\t\t\t\t\t\tconst fileid = getFileId(res.data)\n\t\t\t\t\t\t\tconst contentType = getContentType(res.data)\n\t\t\t\t\t\t\tif (fileid !== -1 && contentType === '') {\n\t\t\t\t\t\t\t\t// Add directory name\n\t\t\t\t\t\t\t\tthis.excludeDirectoriesNames.push(dir.split('/')[dir.split('/').length - 1])\n\t\t\t\t\t\t\t} else if (fileid !== -1\n\t\t\t\t\t\t\t\t&& (contentType.split('/')[0] === 'image' || contentType.split('/')[0] === 'video')) {\n\t\t\t\t\t\t\t\t// Add as fileid exclude\n\t\t\t\t\t\t\t\tthis.excludeFileIds[fileid.toString()] = dir.split('/')[dir.split('/').length - 1]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.excludeDirectoriesNames.push('/')\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(t('mediadc', 'This directory already excluded'))\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\trunCollectorTask() {\n\t\t\tthis.runningTask = true\n\t\t\taxios.post(generateUrl('/apps/mediadc/api/v1/tasks/run'), {\n\t\t\t\ttargetDirectoryIds: JSON.stringify(this.targetDirectoriesIds),\n\t\t\t\texcludeList: {\n\t\t\t\t\tuser: {\n\t\t\t\t\t\tmask: [...this.excludeDirectoriesNames, ...this.customExcludeList],\n\t\t\t\t\t\tfileid: Object.keys(this.excludeFileIds),\n\t\t\t\t\t},\n\t\t\t\t\tadmin: JSON.parse(this.settingByName('exclude_list').value) || { mask: [], fileid: [] },\n\t\t\t\t},\n\t\t\t\tcollectorSettings: {\n\t\t\t\t\thashing_algorithm: JSON.parse(this.settingByName('hashing_algorithm').value) || 'phash',\n\t\t\t\t\tsimilarity_threshold: this.similarity_threshold,\n\t\t\t\t\thash_size: this.settingByName('hash_size').value || 64,\n\t\t\t\t\ttarget_mtype: this.targetMimeType,\n\t\t\t\t},\n\t\t\t}).then(res => {\n\t\t\t\tthis.runningTask = false\n\t\t\t\tif (res.data.success) {\n\t\t\t\t\tthis.$emit('update:loading', true)\n\t\t\t\t\tthis.getTasks()\n\t\t\t\t\tthis.resetForm()\n\t\t\t\t\tshowSuccess(t('mediadc', 'New task successfully created!'))\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning('Some error occured while running Collector Task. Try again.')\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tremoveTargetDirectory(fileid) {\n\t\t\tdelete this.targetDirectoriesPaths[fileid]\n\t\t\tconst fileidIndex = this.targetDirectoriesIds.findIndex(id => id === fileid)\n\t\t\tthis.targetDirectoriesIds.splice(fileidIndex, 1)\n\t\t},\n\t\tremoveExcludeDirectory(dir) {\n\t\t\tconst dirIndex = this.excludeDirectoriesNames.findIndex(targetDir => targetDir === dir)\n\t\t\tthis.excludeDirectoriesNames.splice(dirIndex, 1)\n\t\t},\n\t\tremoveExcludeFileid(fileid) {\n\t\t\tdelete this.excludeFileIds[fileid]\n\t\t},\n\t\taddNewMask() {\n\t\t\tthis.addingCustomMask = true\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$refs.customExcludeMask.focus()\n\t\t\t}, 100)\n\t\t},\n\t\taddCustomMask() {\n\t\t\tif (this.customExcludeMask.length > 0) {\n\t\t\t\tif (this.customExcludeList.findIndex(mask => mask === this.customExcludeMask) === -1) {\n\t\t\t\t\tthis.customExcludeList.push(this.customExcludeMask)\n\t\t\t\t\tthis.customExcludeMask = ''\n\t\t\t\t\tthis.addingCustomMask = false\n\t\t\t\t} else {\n\t\t\t\t\tshowWarning(t('mediadc', 'This mask already exists!'))\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'Enter custom mask!'))\n\t\t\t}\n\t\t},\n\t\tcancelAddingCustomMask() {\n\t\t\tthis.customExcludeMask = ''\n\t\t\tthis.addingCustomMask = false\n\t\t},\n\t\tdeleteCustomMask(mask) {\n\t\t\tconst maskIndex = this.customExcludeList.findIndex(m => m === mask)\n\t\t\tthis.customExcludeList.splice(maskIndex, 1)\n\t\t},\n\t\tasync getTasks() {\n\t\t\taxios.get(generateUrl('/apps/mediadc/api/v1/tasks')).then(res => {\n\t\t\t\tthis.$store.dispatch('setTasks', res.data)\n\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t})\n\t\t},\n\t\tresetForm() {\n\t\t\tthis.targetDirectoriesPaths = {}\n\t\t\tthis.targetDirectoriesIds = []\n\t\t\tthis.excludeDirectoriesNames = []\n\t\t\tthis.excludeFileIds = {}\n\t\t\tthis.targetMimeType = 0\n\t\t\tthis.similarity_threshold = this.settingByName('similarity_threshold') !== undefined\n\t\t\t\t? this.settingByName('similarity_threshold').value\n\t\t\t\t: 90\n\t\t\tthis.customExcludeList = []\n\t\t\tthis.runningTask = false\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.new-task-block {\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tbox-shadow: 0 0 4px 0 rgba(0, 0, 0, .05);\n\tpadding: 20px;\n\tmargin: 10px;\n\twidth: 100%;\n\tmax-width: 600px;\n}\n\n.selection-container {\n\twidth: 100%;\n\tdisplay: flex;\n}\n\n@media (max-width: 767px) {\n\t.selection-container {\n\t\tflex-wrap: wrap;\n\t}\n}\n\n.block {\n\twidth: 100%;\n\theight: 100%;\n\tmax-height: 200px;\n\toverflow-y: scroll;\n\tpadding: 10px 15px;\n\tmargin: 5px 10px;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n}\n\n.block:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, .05)\n}\n\n.target-directory, .custom-mask {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tpadding: 5px 0;\n\tborder-bottom: 1px solid #dadada;\n}\n\n.delete-button {\n\tdisplay: inline-flex;\n\twidth: 15px;\n\theight: 15px;\n\tcursor: pointer;\n\tmargin: 0 10px;\n}\n\nbody.theme--dark .new-task-block, body.theme--dark .block {\n\tborder-color: #717171;\n}\n</style>\n"],sourceRoot:""}]),e.a=i},455:function(t,e,n){"use strict";var s=n(66),i=n.n(s)()(!0);i.push([t.i,"\n.tasks-list[data-v-3b58d82a] {\n\tpadding: 20px;\n\tbackground-color: #E6F3FA;\n\tborder-radius: 5px;\n\twidth: 100%;\n\tmargin: 10px;\n\tmax-width: 600px;\n\tmax-height: 410px;\n\tmin-height: 410px;\n\toverflow-y: scroll;\n}\n.task-row[data-v-3b58d82a] {\n\tdisplay: flex;\n\talign-items: center;\n\tborder: 1px solid #dadada;\n\tbackground-color: #fff;\n\tborder-radius: 5px;\n\tmargin-bottom: 10px;\n\ttransition: box-shadow .3s;\n}\n.task-row[data-v-3b58d82a]:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);\n}\n.task-row:hover .delete-task-button[data-v-3b58d82a] {\n\tvisibility: visible;\n}\n.task-row a[data-v-3b58d82a] {\n\tpadding: 10px 0 10px 20px;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: inline-flex;\n\talign-items: center;\n}\n.delete-task-button[data-v-3b58d82a] {\n\tdisplay: inline-flex;\n\tvisibility: hidden;\n\twidth: 16px;\n\theight: 16px;\n\tmargin: 10px 20px;\n\tcursor: pointer;\n}\n.task-owner[data-v-3b58d82a] {\n\tcolor: #585858;\n}\n@media (max-width: 540px) {\n.task-row[data-v-3b58d82a], .task-row a[data-v-3b58d82a] {\n\t\tflex-direction: column;\n}\n.delete-task-button[data-v-3b58d82a] {\n\t\tvisibility: visible;\n}\n.badge[data-v-3b58d82a] {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n}\n}\n.badge[data-v-3b58d82a] {\n\tdisplay: inline-flex;\n\tpadding: 0 10px;\n\tbackground-color: #eee;\n\tborder-radius: 20px;\n\tmargin-right: 10px;\n}\n.badge.finished[data-v-3b58d82a] {\n\tbackground-color: #49b382;\n\tcolor: #fff;\n}\n.badge.running[data-v-3b58d82a] {\n\tbackground-color: #dadada;\n\tcolor: #000;\n}\n.badge.error[data-v-3b58d82a] {\n\tbackground-color: #bd3f3f;\n\tcolor: #fff;\n}\n.badge.terminated[data-v-3b58d82a] {\n\tbackground-color: #f17b1b;\n\tcolor: #fff;\n}\n.empty-tasks-list[data-v-3b58d82a] {\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 80%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-sizing: border-box;\n\tflex-direction: column;\n}\n.empty-tasks-list strong[data-v-3b58d82a] {\n\tfont-size: 16px;\n\tcolor: #636363;\n}\n.empty-tasks-list img[data-v-3b58d82a] {\n\tmargin: 20px 0;\n}\nbody.theme--dark .tasks-list[data-v-3b58d82a] {\n\tbackground-color: #333333;\n}\nbody.theme--dark .task-row[data-v-3b58d82a] {\n\tbackground-color: #353535;\n\tborder-color: #717171;\n}\nbody.theme--dark .task-owner[data-v-3b58d82a] {\n\tcolor: #a9a8a8;\n}\n","",{version:3,sources:["webpack://src/components/tasks/TasksList.vue"],names:[],mappings:";AAoGA;CACA,aAAA;CACA,yBAAA;CACA,kBAAA;CACA,WAAA;CACA,YAAA;CACA,gBAAA;CACA,iBAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,yBAAA;CACA,sBAAA;CACA,kBAAA;CACA,mBAAA;CACA,0BAAA;AACA;AAEA;CACA,yCAAA;AACA;AAEA;CACA,mBAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;CACA,YAAA;CACA,oBAAA;CACA,mBAAA;AACA;AAEA;CACA,oBAAA;CACA,kBAAA;CACA,WAAA;CACA,YAAA;CACA,iBAAA;CACA,eAAA;AACA;AAEA;CACA,cAAA;AACA;AAEA;AACA;EACA,sBAAA;AACA;AACA;EACA,mBAAA;AACA;AACA;EACA,eAAA;EACA,mBAAA;AACA;AACA;AAEA;CACA,oBAAA;CACA,eAAA;CACA,sBAAA;CACA,mBAAA;CACA,kBAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,aAAA;CACA,WAAA;CACA,WAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,sBAAA;CACA,sBAAA;AACA;AAEA;CACA,eAAA;CACA,cAAA;AACA;AAEA;CACA,cAAA;AACA;AAEA;CACA,yBAAA;AACA;AAEA;CACA,yBAAA;CACA,qBAAA;AACA;AAEA;CACA,cAAA;AACA",sourcesContent:["\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"tasks-list\">\n\t\t<h2>{{ t('mediadc', 'Recent Tasks') }}</h2>\n\t\t<div v-if=\"tasks.length > 0\">\n\t\t\t<div v-for=\"task in tasks\"\n\t\t\t\t:key=\"task.id\"\n\t\t\t\tclass=\"task-row\">\n\t\t\t\t<router-link :to=\"{ name: 'collectorDetails', params: { taskId: task.id } }\">\n\t\t\t\t\t<span :class=\"'badge ' + getStatusBadge(task)\">{{ getStatusBadge(task) }}</span>\n\t\t\t\t\t<div style=\"display: flex; flex-wrap: wrap;\">\n\t\t\t\t\t\t<span style=\"width: 100%;\">\n\t\t\t\t\t\t\t<b>{{ t('mediadc', 'Task #') }}{{ parseTargetMtype(task) }}</b> {{ task.files_scanned !== task.files_total ? `${task.files_scanned}/` : '' }}{{ task.files_total }} file(s)\n\t\t\t\t\t\t\t({{ formatBytes(Number(task.files_total_size)) }})\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span style=\"width: 100%;\">\n\t\t\t\t\t\t\t{{ t('mediadc', 'by') }} <span class=\"task-owner\">{{ task.owner + ' ' }}</span>\n\t\t\t\t\t\t\t({{ parseUnixTimestamp(task.created_time) }}{{ Number(task.finished_time) > 0 ? ' - ' + parseUnixTimestamp(task.finished_time) : '' }})\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</router-link>\n\t\t\t\t<span class=\"delete-task-button icon-delete\" @click=\"deleteTask(task)\" />\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-else class=\"empty-tasks-list\">\n\t\t\t<img src=\"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDM4Ljg5MSA0MzguODkxIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0MzguODkxIDQzOC44OTE7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxnPg0KCQk8Zz4NCgkJCTxwYXRoIGQ9Ik0zNDcuOTY4LDU3LjUwM2gtMzkuNzA2VjM5Ljc0YzAtNS43NDctNi4yNjktOC4zNTktMTIuMDE2LTguMzU5aC0zMC44MjRjLTcuMzE0LTIwLjg5OC0yNS42LTMxLjM0Ny00Ni40OTgtMzEuMzQ3DQoJCQkJYy0yMC42NjgtMC43NzctMzkuNDY3LDExLjg5Ni00Ni40OTgsMzEuMzQ3aC0zMC4zMDJjLTUuNzQ3LDAtMTEuNDk0LDIuNjEyLTExLjQ5NCw4LjM1OXYxNy43NjNIOTAuOTIzDQoJCQkJYy0yMy41MywwLjI1MS00Mi43OCwxOC44MTMtNDMuODg2LDQyLjMxOHYyOTkuMzYzYzAsMjIuOTg4LDIwLjg5OCwzOS43MDYsNDMuODg2LDM5LjcwNmgyNTcuMDQ1DQoJCQkJYzIyLjk4OCwwLDQzLjg4Ni0xNi43MTgsNDMuODg2LTM5LjcwNlY5OS44MjJDMzkwLjc0OCw3Ni4zMTYsMzcxLjQ5OCw1Ny43NTQsMzQ3Ljk2OCw1Ny41MDN6IE0xNTEuNTI3LDUyLjI3OWgyOC43MzUNCgkJCQljNS4wMTYtMC42MTIsOS4wNDUtNC40MjgsOS45MjctOS40MDRjMy4wOTQtMTMuNDc0LDE0LjkxNS0yMy4xNDYsMjguNzM1LTIzLjUxYzEzLjY5MiwwLjQxNSwyNS4zMzUsMTAuMTE3LDI4LjIxMiwyMy41MQ0KCQkJCWMwLjkzNyw1LjE0OCw1LjIzMiw5LjAxMywxMC40NDksOS40MDRoMjkuNzh2NDEuNzk2SDE1MS41MjdWNTIuMjc5eiBNMzcwLjk1NiwzOTkuMTg1YzAsMTEuNDk0LTExLjQ5NCwxOC44MDgtMjIuOTg4LDE4LjgwOA0KCQkJCUg5MC45MjNjLTExLjQ5NCwwLTIyLjk4OC03LjMxNC0yMi45ODgtMTguODA4Vjk5LjgyMmMxLjA2Ni0xMS45NjQsMTAuOTc4LTIxLjIwMSwyMi45ODgtMjEuNDJoMzkuNzA2djI2LjY0NQ0KCQkJCWMwLjU1Miw1Ljg1NCw1LjYyMiwxMC4yMzMsMTEuNDk0LDkuOTI3aDE1NC4xMjJjNS45OCwwLjMyNywxMS4yMDktMy45OTIsMTIuMDE2LTkuOTI3Vjc4LjQwMWgzOS43MDYNCgkJCQljMTIuMDA5LDAuMjIsMjEuOTIyLDkuNDU2LDIyLjk4OCwyMS40MlYzOTkuMTg1eiIvPg0KCQkJPHBhdGggZD0iTTE3OS4yMTcsMjMzLjU2OWMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzY0LTE0LjYyOS0wLjUyMmwtMzMuNDM3LDMxLjg2OWwtMTQuMTA2LTE0LjYyOQ0KCQkJCWMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzYzLTE0LjYyOS0wLjUyMmMtNC4wNDcsNC4yNC00LjA0NywxMC45MTEsMCwxNS4xNTFsMjEuNDIsMjEuOTQzYzEuODU0LDIuMDc2LDQuNTMyLDMuMjI0LDcuMzE0LDMuMTM1DQoJCQkJYzIuNzU2LTAuMDM5LDUuMzg1LTEuMTY2LDcuMzE0LTMuMTM1bDQwLjc1MS0zOC42NjFjNC4wNC0zLjcwNiw0LjMxLTkuOTg2LDAuNjAzLTE0LjAyNQ0KCQkJCUMxNzkuNjI4LDIzMy45NjIsMTc5LjQyNywyMzMuNzYxLDE3OS4yMTcsMjMzLjU2OXoiLz4NCgkJCTxwYXRoIGQ9Ik0zMjkuMTYsMjU2LjAzNEgyMDguOTk3Yy01Ljc3MSwwLTEwLjQ0OSw0LjY3OC0xMC40NDksMTAuNDQ5czQuNjc4LDEwLjQ0OSwxMC40NDksMTAuNDQ5SDMyOS4xNg0KCQkJCWM1Ljc3MSwwLDEwLjQ0OS00LjY3OCwxMC40NDktMTAuNDQ5UzMzNC45MzEsMjU2LjAzNCwzMjkuMTYsMjU2LjAzNHoiLz4NCgkJCTxwYXRoIGQ9Ik0xNzkuMjE3LDE0OS45NzdjLTMuOTE5LTQuMTMxLTEwLjQyNS00LjM2NC0xNC42MjktMC41MjJsLTMzLjQzNywzMS44NjlsLTE0LjEwNi0xNC42MjkNCgkJCQljLTMuOTE5LTQuMTMxLTEwLjQyNS00LjM2NC0xNC42MjktMC41MjJjLTQuMDQ3LDQuMjQtNC4wNDcsMTAuOTExLDAsMTUuMTUxbDIxLjQyLDIxLjk0M2MxLjg1NCwyLjA3Niw0LjUzMiwzLjIyNCw3LjMxNCwzLjEzNQ0KCQkJCWMyLjc1Ni0wLjAzOSw1LjM4NS0xLjE2Niw3LjMxNC0zLjEzNWw0MC43NTEtMzguNjYxYzQuMDQtMy43MDYsNC4zMS05Ljk4NiwwLjYwMy0xNC4wMjUNCgkJCQlDMTc5LjYyOCwxNTAuMzcsMTc5LjQyNywxNTAuMTY5LDE3OS4yMTcsMTQ5Ljk3N3oiLz4NCgkJCTxwYXRoIGQ9Ik0zMjkuMTYsMTcyLjQ0MkgyMDguOTk3Yy01Ljc3MSwwLTEwLjQ0OSw0LjY3OC0xMC40NDksMTAuNDQ5czQuNjc4LDEwLjQ0OSwxMC40NDksMTAuNDQ5SDMyOS4xNg0KCQkJCWM1Ljc3MSwwLDEwLjQ0OS00LjY3OCwxMC40NDktMTAuNDQ5UzMzNC45MzEsMTcyLjQ0MiwzMjkuMTYsMTcyLjQ0MnoiLz4NCgkJCTxwYXRoIGQ9Ik0xNzkuMjE3LDMxNy4xNmMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzYzLTE0LjYyOS0wLjUyMmwtMzMuNDM3LDMxLjg2OWwtMTQuMTA2LTE0LjYyOQ0KCQkJCWMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzYzLTE0LjYyOS0wLjUyMmMtNC4wNDcsNC4yNC00LjA0NywxMC45MTEsMCwxNS4xNTFsMjEuNDIsMjEuOTQzYzEuODU0LDIuMDc2LDQuNTMyLDMuMjI0LDcuMzE0LDMuMTM1DQoJCQkJYzIuNzU2LTAuMDM5LDUuMzg1LTEuMTY2LDcuMzE0LTMuMTM1bDQwLjc1MS0zOC42NjFjNC4wNC0zLjcwNiw0LjMxLTkuOTg2LDAuNjAzLTE0LjAyNQ0KCQkJCUMxNzkuNjI4LDMxNy41NTQsMTc5LjQyNywzMTcuMzUzLDE3OS4yMTcsMzE3LjE2eiIvPg0KCQkJPHBhdGggZD0iTTMyOS4xNiwzMzkuNjI2SDIwOC45OTdjLTUuNzcxLDAtMTAuNDQ5LDQuNjc4LTEwLjQ0OSwxMC40NDlzNC42NzgsMTAuNDQ5LDEwLjQ0OSwxMC40NDlIMzI5LjE2DQoJCQkJYzUuNzcxLDAsMTAuNDQ5LTQuNjc4LDEwLjQ0OS0xMC40NDlTMzM0LjkzMSwzMzkuNjI2LDMyOS4xNiwzMzkuNjI2eiIvPg0KCQk8L2c+DQoJPC9nPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPC9zdmc+DQo=\" width=\"96\" height=\"96\">\n\t\t\t<strong>{{ t('mediadc', 'No tasks yet. Create a new one!') }}</strong>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { generateUrl } from '@nextcloud/router'\nimport { mapGetters } from 'vuex'\nimport Formats from '../../mixins/Formats'\n\nexport default {\n\tname: 'TasksList',\n\tmixins: [Formats],\n\tdata() {\n\t\treturn {\n\t\t\ttasksUpdater: null,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'settings',\n\t\t\t'tasks',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.tasksUpdater = setInterval(this.getTasks, 5000)\n\t},\n\tbeforeDestroy() {\n\t\tclearInterval(this.tasksUpdater)\n\t},\n\tmethods: {\n\t\tasync getTasks() {\n\t\t\taxios.get(generateUrl('/apps/mediadc/api/v1/tasks')).then(res => {\n\t\t\t\tthis.$store.dispatch('setTasks', res.data)\n\t\t\t})\n\t\t},\n\t\tdeleteTask(task) {\n\t\t\taxios.delete(generateUrl(`/apps/mediadc/api/v1/tasks/${task.id}`)).then(res => {\n\t\t\t\tthis.getTasks()\n\t\t\t})\n\t\t},\n\t\tterminateTask(taskId) {\n\t\t\taxios.post(generateUrl(`/apps/mediadc/api/v1/tasks/${taskId}/terminate`), { taskId }).then(res => {\n\t\t\t\tthis.getTasks()\n\t\t\t})\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.tasks-list {\n\tpadding: 20px;\n\tbackground-color: #E6F3FA;\n\tborder-radius: 5px;\n\twidth: 100%;\n\tmargin: 10px;\n\tmax-width: 600px;\n\tmax-height: 410px;\n\tmin-height: 410px;\n\toverflow-y: scroll;\n}\n\n.task-row {\n\tdisplay: flex;\n\talign-items: center;\n\tborder: 1px solid #dadada;\n\tbackground-color: #fff;\n\tborder-radius: 5px;\n\tmargin-bottom: 10px;\n\ttransition: box-shadow .3s;\n}\n\n.task-row:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.1);\n}\n\n.task-row:hover .delete-task-button {\n\tvisibility: visible;\n}\n\n.task-row a {\n\tpadding: 10px 0 10px 20px;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: inline-flex;\n\talign-items: center;\n}\n\n.delete-task-button {\n\tdisplay: inline-flex;\n\tvisibility: hidden;\n\twidth: 16px;\n\theight: 16px;\n\tmargin: 10px 20px;\n\tcursor: pointer;\n}\n\n.task-owner {\n\tcolor: #585858;\n}\n\n@media (max-width: 540px) {\n\t.task-row, .task-row a {\n\t\tflex-direction: column;\n\t}\n\t.delete-task-button {\n\t\tvisibility: visible;\n\t}\n\t.badge {\n\t\tmargin-right: 0;\n\t\tmargin-bottom: 10px;\n\t}\n}\n\n.badge {\n\tdisplay: inline-flex;\n\tpadding: 0 10px;\n\tbackground-color: #eee;\n\tborder-radius: 20px;\n\tmargin-right: 10px;\n}\n\n.badge.finished {\n\tbackground-color: #49b382;\n\tcolor: #fff;\n}\n\n.badge.running {\n\tbackground-color: #dadada;\n\tcolor: #000;\n}\n\n.badge.error {\n\tbackground-color: #bd3f3f;\n\tcolor: #fff;\n}\n\n.badge.terminated {\n\tbackground-color: #f17b1b;\n\tcolor: #fff;\n}\n\n.empty-tasks-list {\n\tpadding: 20px;\n\twidth: 100%;\n\theight: 80%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbox-sizing: border-box;\n\tflex-direction: column;\n}\n\n.empty-tasks-list strong {\n\tfont-size: 16px;\n\tcolor: #636363;\n}\n\n.empty-tasks-list img {\n\tmargin: 20px 0;\n}\n\nbody.theme--dark .tasks-list {\n\tbackground-color: #333333;\n}\n\nbody.theme--dark .task-row {\n\tbackground-color: #353535;\n\tborder-color: #717171;\n}\n\nbody.theme--dark .task-owner {\n\tcolor: #a9a8a8;\n}\n</style>\n"],sourceRoot:""}]),e.a=i},456:function(t,e,n){"use strict";var s=n(66),i=n.n(s)()(!0);i.push([t.i,"\n.container[data-v-4f1fe312] {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n}\nh1[data-v-4f1fe312] {\n\tfont-size: 24px;\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin: 20px 0 10px;\n}\nbutton[data-v-4f1fe312] {\n\tmargin: 20px 0;\n}\np[data-v-4f1fe312] {\n\tpadding: 0 10px;\n\tmargin: 10px 0;\n\ttext-align: center;\n}\n.mediadc-row[data-v-4f1fe312] {\n\tdisplay: flex;\n\tjustify-content: center;\n}\n@media (max-width: 960px) {\n.mediadc-row[data-v-4f1fe312] {\n\t\tflex-wrap: wrap;\n\t\tjustify-content: center;\n}\n}\n","",{version:3,sources:["webpack://src/views/Collector.vue"],names:[],mappings:";AAoGA;CACA,eAAA;CACA,WAAA;CACA,iBAAA;CACA,cAAA;AACA;AAEA;CACA,eAAA;CACA,iBAAA;CACA,kBAAA;CACA,mBAAA;AACA;AAEA;CACA,cAAA;AACA;AAEA;CACA,eAAA;CACA,cAAA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,uBAAA;AACA;AAEA;AACA;EACA,eAAA;EACA,uBAAA;AACA;AACA",sourcesContent:["\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div v-if=\"!loading\" class=\"container\">\n\t\t<div class=\"heading\">\n\t\t\t<h1>{{ rootTitle }}</h1>\n\t\t\t<p>\n\t\t\t\t{{ t('mediadc_collector_welcome',\n\t\t\t\t\t'Welcome to Media Duplicate Collector (MediaDC). ' +\n\t\t\t\t\t\t'Here you can manage your duplicate collection tasks and ' +\n\t\t\t\t\t\t'see the history of previous finished tasks.')\n\t\t\t\t}}\n\t\t\t</p>\n\t\t</div>\n\t\t<div class=\"mediadc-row\">\n\t\t\t<TasksNew />\n\t\t\t<TasksList />\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { generateUrl } from '@nextcloud/router'\nimport { mapGetters } from 'vuex'\n\nimport Configure from '../mixins/Configure'\nimport TasksNew from '../components/tasks/TasksNew'\nimport TasksList from '../components/tasks/TasksList'\n\nexport default {\n\tname: 'Collector',\n\tcomponents: {\n\t\tTasksNew,\n\t\tTasksList,\n\t},\n\tmixins: [\n\t\tConfigure,\n\t],\n\tprops: {\n\t\trootTitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tupdating: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'settings',\n\t\t\t'tasks',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.getContent()\n\t},\n\tmethods: {\n\t\tasync getContent() {\n\t\t\tthis.$emit('update:loading', true)\n\t\t\tthis.getTasks()\n\t\t},\n\t\tasync getTasks() {\n\t\t\taxios.get(generateUrl('/apps/mediadc/api/v1/tasks')).then(res => {\n\t\t\t\tthis.$store.dispatch('setTasks', res.data)\n\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t})\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.container {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n}\n\nh1 {\n\tfont-size: 24px;\n\tfont-weight: bold;\n\ttext-align: center;\n\tmargin: 20px 0 10px;\n}\n\nbutton {\n\tmargin: 20px 0;\n}\n\np {\n\tpadding: 0 10px;\n\tmargin: 10px 0;\n\ttext-align: center;\n}\n\n.mediadc-row {\n\tdisplay: flex;\n\tjustify-content: center;\n}\n\n@media (max-width: 960px) {\n\t.mediadc-row {\n\t\tflex-wrap: wrap;\n\t\tjustify-content: center;\n\t}\n}\n</style>\n"],sourceRoot:""}]),e.a=i},463:function(e,n,s){"use strict";s.r(n);var i=s(22),a=s.n(i),r=s(12),o=s(194),c=s(379),d=s(18),l=s(378);function u(t,e,n,s,i,a,r){try{var o=t[a](r),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(s,i)}function A(t){return function(t){if(Array.isArray(t))return m(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return m(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,s=new Array(e);n<e;n++)s[n]=t[n];return s}function M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function g(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p={name:"TasksNew",data:function(){return{targetDirectoriesPaths:{},targetDirectoriesIds:[],excludeDirectoriesNames:[],excludeFileIds:{},targetMimeType:0,similarity_threshold:90,customExcludeList:[],customExcludeMask:"",addingCustomMask:!1,runningTask:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?M(Object(n),!0).forEach((function(e){g(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(o.c)(["settings","settingByName","tasks"])),beforeMount:function(){this.similarity_threshold=void 0!==this.settingByName("similarity_threshold")?this.settingByName("similarity_threshold").value:90},methods:{getDirectoriesPicker:function(t){return Object(d.a)(t).setMultiSelect(!1).addMimeTypeFilter("httpd/unix-directory").setModal(!0).setType(1).allowDirectories(!0).build()},getFilesPicker:function(t){return Object(d.a)(t).setMultiSelect(!1).setModal(!0).setType(1).allowDirectories(!0).build()},openDirectoriesExplorer:function(){var e=this;this.getDirectoriesPicker(t("mediadc","Choose target directory")).pick().then((function(n){n.startsWith("/")?Object(l.d)(n).then((function(s){var i=Object(l.c)(s.data);-1!==i&&(i in e.targetDirectoriesPaths?Object(d.d)(t("mediadc","This directory already selected")):(e.targetDirectoriesIds.push(i),e.targetDirectoriesPaths[i.toString()]=n))})):(Object(l.d)("/").then((function(n){var s=Object(l.c)(n.data);-1!==s&&(s in e.targetDirectoriesPaths?Object(d.d)(t("mediadc","This directory already selected")):(e.targetDirectoriesIds.push(s),e.targetDirectoriesPaths[s.toString()]="/"))})),e.targetDirectoriesPaths.push("/"))}))},openExcludeExplorer:function(){var e=this;this.getDirectoriesPicker(t("mediadc","Choose directory to exclude")).pick().then((function(n){-1===e.excludeDirectoriesNames.findIndex((function(t){return t===n}))?n.startsWith("/")?Object(l.d)(n).then((function(t){var s=Object(l.c)(t.data),i=Object(l.b)(t.data);-1!==s&&""===i?e.excludeDirectoriesNames.push(n.split("/")[n.split("/").length-1]):-1===s||"image"!==i.split("/")[0]&&"video"!==i.split("/")[0]||(e.excludeFileIds[s.toString()]=n.split("/")[n.split("/").length-1])})):e.excludeDirectoriesNames.push("/"):Object(d.d)(t("mediadc","This directory already excluded"))}))},runCollectorTask:function(){var e=this;this.runningTask=!0,a.a.post(Object(r.generateUrl)("/apps/mediadc/api/v1/tasks/run"),{targetDirectoryIds:JSON.stringify(this.targetDirectoriesIds),excludeList:{user:{mask:[].concat(A(this.excludeDirectoriesNames),A(this.customExcludeList)),fileid:Object.keys(this.excludeFileIds)},admin:JSON.parse(this.settingByName("exclude_list").value)||{mask:[],fileid:[]}},collectorSettings:{hashing_algorithm:JSON.parse(this.settingByName("hashing_algorithm").value)||"phash",similarity_threshold:this.similarity_threshold,hash_size:this.settingByName("hash_size").value||64,target_mtype:this.targetMimeType}}).then((function(n){e.runningTask=!1,n.data.success?(e.$emit("update:loading",!0),e.getTasks(),e.resetForm(),Object(d.c)(t("mediadc","New task successfully created!"))):Object(d.d)("Some error occured while running Collector Task. Try again.")}))},removeTargetDirectory:function(t){delete this.targetDirectoriesPaths[t];var e=this.targetDirectoriesIds.findIndex((function(e){return e===t}));this.targetDirectoriesIds.splice(e,1)},removeExcludeDirectory:function(t){var e=this.excludeDirectoriesNames.findIndex((function(e){return e===t}));this.excludeDirectoriesNames.splice(e,1)},removeExcludeFileid:function(t){delete this.excludeFileIds[t]},addNewMask:function(){var t=this;this.addingCustomMask=!0,setTimeout((function(){t.$refs.customExcludeMask.focus()}),100)},addCustomMask:function(){var e=this;this.customExcludeMask.length>0?-1===this.customExcludeList.findIndex((function(t){return t===e.customExcludeMask}))?(this.customExcludeList.push(this.customExcludeMask),this.customExcludeMask="",this.addingCustomMask=!1):Object(d.d)(t("mediadc","This mask already exists!")):Object(d.d)(t("mediadc","Enter custom mask!"))},cancelAddingCustomMask:function(){this.customExcludeMask="",this.addingCustomMask=!1},deleteCustomMask:function(t){var e=this.customExcludeList.findIndex((function(e){return e===t}));this.customExcludeList.splice(e,1)},getTasks:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.a.get(Object(r.generateUrl)("/apps/mediadc/api/v1/tasks")).then((function(t){e.$store.dispatch("setTasks",t.data),e.$emit("update:loading",!1)}));case 1:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){u(a,s,i,r,o,"next",t)}function o(t){u(a,s,i,r,o,"throw",t)}r(void 0)}))})()},resetForm:function(){this.targetDirectoriesPaths={},this.targetDirectoriesIds=[],this.excludeDirectoriesNames=[],this.excludeFileIds={},this.targetMimeType=0,this.similarity_threshold=void 0!==this.settingByName("similarity_threshold")?this.settingByName("similarity_threshold").value:90,this.customExcludeList=[],this.runningTask=!1}}},C=s(65),h=s.n(C),k=s(454),j={insert:"head",singleton:!1},y=(h()(k.a,j),k.a.locals,s(67)),x=Object(y.a)(p,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"new-task-block"},[n("h2",[t._v(t._s(t.t("mediadc","Create a new Task")))]),t._v(" "),n("div",{staticClass:"selection-container"},[n("div",{staticClass:"block target-directories-block"},[n("h3",[t._v(t._s(t.t("mediadc","Target directories")))]),t._v(" "),t.targetDirectoriesIds.length>0?n("div",t._l(t.targetDirectoriesIds,(function(e){return n("div",{key:e,staticClass:"selected-target-directories-list"},[n("div",{staticClass:"target-directory"},[n("span",{staticStyle:{"overflow-y":"scroll"}},[t._v(t._s(t.targetDirectoriesPaths[e]))]),t._v(" "),n("span",{staticClass:"delete-button icon-delete",on:{click:function(n){return t.removeTargetDirectory(e)}}})])])})),0):n("div",[n("span",[t._v(t._s(t.t("mediadc","Not selected")))])]),t._v(" "),n("br"),t._v(" "),n("button",{on:{click:t.openDirectoriesExplorer}},[n("span",{staticClass:"icon-add"}),t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Select"))+"\n\t\t\t")])]),t._v(" "),n("div",{staticClass:"block"},[n("h3",[t._v(t._s(t.t("mediadc","Exclude directories")))]),t._v(" "),t.excludeDirectoriesNames.length>0?n("div",t._l(t.excludeDirectoriesNames,(function(e){return n("div",{key:e,staticClass:"selected-excluded-directories-list"},[n("div",{staticClass:"target-directory"},[n("span",{staticStyle:{"overflow-y":"scroll"}},[t._v(t._s(e))]),t._v(" "),n("span",{staticClass:"delete-button icon-delete",on:{click:function(n){return t.removeExcludeDirectory(e)}}})])])})),0):n("div",[n("span",[t._v(t._s(t.t("mediadc","Not selected")))])]),t._v(" "),Object.keys(t.excludeFileIds).length>0?n("div",t._l(t.excludeFileIds,(function(e){return n("div",{key:e},[n("div",{staticClass:"target-directory"},[n("span",{staticStyle:{"overflow-y":"scroll"}},[t._v(t._s(t.excludeFileIds[e]))]),t._v(" "),n("span",{staticClass:"delete-button icon-delete",on:{click:function(n){return t.removeExcludeFileid(e)}}})])])})),0):t._e(),t._v(" "),n("br"),t._v(" "),n("button",{on:{click:t.openExcludeExplorer}},[n("span",{staticClass:"icon-add"}),t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Select"))+"\n\t\t\t")])])]),t._v(" "),n("div",{staticClass:"selection-container"},[n("div",{staticClass:"block"},[n("h3",[t._v(t._s(t.t("mediadc","Custom exclude mask")))]),t._v(" "),t.customExcludeList.length>0?n("div",{staticClass:"custom-masks-list"},t._l(t.customExcludeList,(function(e,s){return n("div",{key:s,staticClass:"custom-mask"},[n("span",[t._v(t._s(e))]),t._v(" "),n("span",{staticClass:"icon-delete",staticStyle:{cursor:"pointer"},on:{click:function(n){return t.deleteCustomMask(e)}}})])})),0):n("div",[n("span",[t._v(t._s(t.t("mediadc","Not added")))])]),t._v(" "),t.addingCustomMask?n("div",{staticStyle:{display:"flex","align-items":"center"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.customExcludeMask,expression:"customExcludeMask"}],ref:"customExcludeMask",attrs:{id:"custom-exclude-mask",type:"text"},domProps:{value:t.customExcludeMask},on:{keyup:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.addCustomMask(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:t.cancelAddingCustomMask(e)}],input:function(e){e.target.composing||(t.customExcludeMask=e.target.value)}}}),t._v(" "),n("span",{staticClass:"icon-checkmark",staticStyle:{width:"18px",height:"18px",margin:"0 5px",display:"inline-block",cursor:"pointer"},on:{click:t.addCustomMask}}),t._v(" "),n("span",{staticClass:"icon-close",staticStyle:{width:"18px",height:"18px",margin:"0 5px",display:"inline-block",cursor:"pointer"},on:{click:t.cancelAddingCustomMask}})]):t._e(),t._v(" "),n("div",{staticStyle:{display:"flex","align-items":"center",margin:"20px 0"}},[n("button",{on:{click:t.addNewMask}},[n("span",{staticClass:"icon-add"}),t._v(" "),n("span",[t._v(t._s(t.t("mediadc","Add mask")))])])])]),t._v(" "),n("div",{staticClass:"block"},[n("h3",{staticStyle:{margin:"5px 0"}},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Target Mime Type"))+"\n\t\t\t")]),t._v(" "),n("select",{directives:[{name:"model",rawName:"v-model",value:t.targetMimeType,expression:"targetMimeType"}],attrs:{id:"target_mtype",name:"target_mtype"},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.targetMimeType=e.target.multiple?n:n[0]}}},[n("option",{domProps:{value:0}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Photos"))+"\n\t\t\t\t")]),t._v(" "),n("option",{domProps:{value:1}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Videos"))+"\n\t\t\t\t")]),t._v(" "),n("option",{domProps:{value:2}},[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Photos and Videos"))+"\n\t\t\t\t")])]),t._v(" "),n("h3",{staticStyle:{margin:"5px 0"}},[t._v("\n\t\t\t\t"+t._s(t.t("mediadc","Similarity threshold"))+"\n\t\t\t")]),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.similarity_threshold,expression:"similarity_threshold"}],staticStyle:{margin:"0 0 10px"},attrs:{type:"number",min:"50",max:"100"},domProps:{value:t.similarity_threshold},on:{input:function(e){e.target.composing||(t.similarity_threshold=e.target.value)}}})])]),t._v(" "),t.runningTask?n("button",{attrs:{disabled:""}},[n("span",{staticClass:"icon-loading"})]):n("button",{staticStyle:{margin:"10px 5px 0"},attrs:{disabled:0===Object.keys(t.targetDirectoriesPaths).length},on:{click:t.runCollectorTask}},[t._v("\n\t\tRun Collector Task\n\t")])])}),[],!1,null,"1cc9e28c",null).exports;function N(t,e,n,s,i,a,r){try{var o=t[a](r),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(s,i)}function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var w={name:"TasksList",mixins:[s(242).a],data:function(){return{tasksUpdater:null}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){f(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(o.c)(["settings","tasks"])),beforeMount:function(){this.tasksUpdater=setInterval(this.getTasks,5e3)},beforeDestroy:function(){clearInterval(this.tasksUpdater)},methods:{getTasks:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a.a.get(Object(r.generateUrl)("/apps/mediadc/api/v1/tasks")).then((function(t){e.$store.dispatch("setTasks",t.data)}));case 1:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){N(a,s,i,r,o,"next",t)}function o(t){N(a,s,i,r,o,"throw",t)}r(void 0)}))})()},deleteTask:function(t){var e=this;a.a.delete(Object(r.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(t.id))).then((function(t){e.getTasks()}))},terminateTask:function(t){var e=this;a.a.post(Object(r.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(t,"/terminate")),{taskId:t}).then((function(t){e.getTasks()}))}}},T=s(455),v={insert:"head",singleton:!1};h()(T.a,v),T.a.locals;function D(t,e,n,s,i,a,r){try{var o=t[a](r),c=o.value}catch(t){return void n(t)}o.done?e(c):Promise.resolve(c).then(s,i)}function b(t){return function(){var e=this,n=arguments;return new Promise((function(s,i){var a=t.apply(e,n);function r(t){D(a,s,i,r,o,"next",t)}function o(t){D(a,s,i,r,o,"throw",t)}r(void 0)}))}}function z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var E={name:"Collector",components:{TasksNew:x,TasksList:Object(y.a)(w,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tasks-list"},[n("h2",[t._v(t._s(t.t("mediadc","Recent Tasks")))]),t._v(" "),t.tasks.length>0?n("div",t._l(t.tasks,(function(e){return n("div",{key:e.id,staticClass:"task-row"},[n("router-link",{attrs:{to:{name:"collectorDetails",params:{taskId:e.id}}}},[n("span",{class:"badge "+t.getStatusBadge(e)},[t._v(t._s(t.getStatusBadge(e)))]),t._v(" "),n("div",{staticStyle:{display:"flex","flex-wrap":"wrap"}},[n("span",{staticStyle:{width:"100%"}},[n("b",[t._v(t._s(t.t("mediadc","Task #"))+t._s(t.parseTargetMtype(e)))]),t._v(" "+t._s(e.files_scanned!==e.files_total?e.files_scanned+"/":"")+t._s(e.files_total)+" file(s)\n\t\t\t\t\t\t("+t._s(t.formatBytes(Number(e.files_total_size)))+")\n\t\t\t\t\t")]),t._v(" "),n("span",{staticStyle:{width:"100%"}},[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mediadc","by"))+" "),n("span",{staticClass:"task-owner"},[t._v(t._s(e.owner+" "))]),t._v("\n\t\t\t\t\t\t("+t._s(t.parseUnixTimestamp(e.created_time))+t._s(Number(e.finished_time)>0?" - "+t.parseUnixTimestamp(e.finished_time):"")+")\n\t\t\t\t\t")])])]),t._v(" "),n("span",{staticClass:"delete-task-button icon-delete",on:{click:function(n){return t.deleteTask(e)}}})],1)})),0):n("div",{staticClass:"empty-tasks-list"},[n("img",{attrs:{src:"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJDYXBhXzEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHg9IjBweCIgeT0iMHB4Ig0KCSB2aWV3Qm94PSIwIDAgNDM4Ljg5MSA0MzguODkxIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA0MzguODkxIDQzOC44OTE7IiB4bWw6c3BhY2U9InByZXNlcnZlIj4NCjxnPg0KCTxnPg0KCQk8Zz4NCgkJCTxwYXRoIGQ9Ik0zNDcuOTY4LDU3LjUwM2gtMzkuNzA2VjM5Ljc0YzAtNS43NDctNi4yNjktOC4zNTktMTIuMDE2LTguMzU5aC0zMC44MjRjLTcuMzE0LTIwLjg5OC0yNS42LTMxLjM0Ny00Ni40OTgtMzEuMzQ3DQoJCQkJYy0yMC42NjgtMC43NzctMzkuNDY3LDExLjg5Ni00Ni40OTgsMzEuMzQ3aC0zMC4zMDJjLTUuNzQ3LDAtMTEuNDk0LDIuNjEyLTExLjQ5NCw4LjM1OXYxNy43NjNIOTAuOTIzDQoJCQkJYy0yMy41MywwLjI1MS00Mi43OCwxOC44MTMtNDMuODg2LDQyLjMxOHYyOTkuMzYzYzAsMjIuOTg4LDIwLjg5OCwzOS43MDYsNDMuODg2LDM5LjcwNmgyNTcuMDQ1DQoJCQkJYzIyLjk4OCwwLDQzLjg4Ni0xNi43MTgsNDMuODg2LTM5LjcwNlY5OS44MjJDMzkwLjc0OCw3Ni4zMTYsMzcxLjQ5OCw1Ny43NTQsMzQ3Ljk2OCw1Ny41MDN6IE0xNTEuNTI3LDUyLjI3OWgyOC43MzUNCgkJCQljNS4wMTYtMC42MTIsOS4wNDUtNC40MjgsOS45MjctOS40MDRjMy4wOTQtMTMuNDc0LDE0LjkxNS0yMy4xNDYsMjguNzM1LTIzLjUxYzEzLjY5MiwwLjQxNSwyNS4zMzUsMTAuMTE3LDI4LjIxMiwyMy41MQ0KCQkJCWMwLjkzNyw1LjE0OCw1LjIzMiw5LjAxMywxMC40NDksOS40MDRoMjkuNzh2NDEuNzk2SDE1MS41MjdWNTIuMjc5eiBNMzcwLjk1NiwzOTkuMTg1YzAsMTEuNDk0LTExLjQ5NCwxOC44MDgtMjIuOTg4LDE4LjgwOA0KCQkJCUg5MC45MjNjLTExLjQ5NCwwLTIyLjk4OC03LjMxNC0yMi45ODgtMTguODA4Vjk5LjgyMmMxLjA2Ni0xMS45NjQsMTAuOTc4LTIxLjIwMSwyMi45ODgtMjEuNDJoMzkuNzA2djI2LjY0NQ0KCQkJCWMwLjU1Miw1Ljg1NCw1LjYyMiwxMC4yMzMsMTEuNDk0LDkuOTI3aDE1NC4xMjJjNS45OCwwLjMyNywxMS4yMDktMy45OTIsMTIuMDE2LTkuOTI3Vjc4LjQwMWgzOS43MDYNCgkJCQljMTIuMDA5LDAuMjIsMjEuOTIyLDkuNDU2LDIyLjk4OCwyMS40MlYzOTkuMTg1eiIvPg0KCQkJPHBhdGggZD0iTTE3OS4yMTcsMjMzLjU2OWMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzY0LTE0LjYyOS0wLjUyMmwtMzMuNDM3LDMxLjg2OWwtMTQuMTA2LTE0LjYyOQ0KCQkJCWMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzYzLTE0LjYyOS0wLjUyMmMtNC4wNDcsNC4yNC00LjA0NywxMC45MTEsMCwxNS4xNTFsMjEuNDIsMjEuOTQzYzEuODU0LDIuMDc2LDQuNTMyLDMuMjI0LDcuMzE0LDMuMTM1DQoJCQkJYzIuNzU2LTAuMDM5LDUuMzg1LTEuMTY2LDcuMzE0LTMuMTM1bDQwLjc1MS0zOC42NjFjNC4wNC0zLjcwNiw0LjMxLTkuOTg2LDAuNjAzLTE0LjAyNQ0KCQkJCUMxNzkuNjI4LDIzMy45NjIsMTc5LjQyNywyMzMuNzYxLDE3OS4yMTcsMjMzLjU2OXoiLz4NCgkJCTxwYXRoIGQ9Ik0zMjkuMTYsMjU2LjAzNEgyMDguOTk3Yy01Ljc3MSwwLTEwLjQ0OSw0LjY3OC0xMC40NDksMTAuNDQ5czQuNjc4LDEwLjQ0OSwxMC40NDksMTAuNDQ5SDMyOS4xNg0KCQkJCWM1Ljc3MSwwLDEwLjQ0OS00LjY3OCwxMC40NDktMTAuNDQ5UzMzNC45MzEsMjU2LjAzNCwzMjkuMTYsMjU2LjAzNHoiLz4NCgkJCTxwYXRoIGQ9Ik0xNzkuMjE3LDE0OS45NzdjLTMuOTE5LTQuMTMxLTEwLjQyNS00LjM2NC0xNC42MjktMC41MjJsLTMzLjQzNywzMS44NjlsLTE0LjEwNi0xNC42MjkNCgkJCQljLTMuOTE5LTQuMTMxLTEwLjQyNS00LjM2NC0xNC42MjktMC41MjJjLTQuMDQ3LDQuMjQtNC4wNDcsMTAuOTExLDAsMTUuMTUxbDIxLjQyLDIxLjk0M2MxLjg1NCwyLjA3Niw0LjUzMiwzLjIyNCw3LjMxNCwzLjEzNQ0KCQkJCWMyLjc1Ni0wLjAzOSw1LjM4NS0xLjE2Niw3LjMxNC0zLjEzNWw0MC43NTEtMzguNjYxYzQuMDQtMy43MDYsNC4zMS05Ljk4NiwwLjYwMy0xNC4wMjUNCgkJCQlDMTc5LjYyOCwxNTAuMzcsMTc5LjQyNywxNTAuMTY5LDE3OS4yMTcsMTQ5Ljk3N3oiLz4NCgkJCTxwYXRoIGQ9Ik0zMjkuMTYsMTcyLjQ0MkgyMDguOTk3Yy01Ljc3MSwwLTEwLjQ0OSw0LjY3OC0xMC40NDksMTAuNDQ5czQuNjc4LDEwLjQ0OSwxMC40NDksMTAuNDQ5SDMyOS4xNg0KCQkJCWM1Ljc3MSwwLDEwLjQ0OS00LjY3OCwxMC40NDktMTAuNDQ5UzMzNC45MzEsMTcyLjQ0MiwzMjkuMTYsMTcyLjQ0MnoiLz4NCgkJCTxwYXRoIGQ9Ik0xNzkuMjE3LDMxNy4xNmMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzYzLTE0LjYyOS0wLjUyMmwtMzMuNDM3LDMxLjg2OWwtMTQuMTA2LTE0LjYyOQ0KCQkJCWMtMy45MTktNC4xMzEtMTAuNDI1LTQuMzYzLTE0LjYyOS0wLjUyMmMtNC4wNDcsNC4yNC00LjA0NywxMC45MTEsMCwxNS4xNTFsMjEuNDIsMjEuOTQzYzEuODU0LDIuMDc2LDQuNTMyLDMuMjI0LDcuMzE0LDMuMTM1DQoJCQkJYzIuNzU2LTAuMDM5LDUuMzg1LTEuMTY2LDcuMzE0LTMuMTM1bDQwLjc1MS0zOC42NjFjNC4wNC0zLjcwNiw0LjMxLTkuOTg2LDAuNjAzLTE0LjAyNQ0KCQkJCUMxNzkuNjI4LDMxNy41NTQsMTc5LjQyNywzMTcuMzUzLDE3OS4yMTcsMzE3LjE2eiIvPg0KCQkJPHBhdGggZD0iTTMyOS4xNiwzMzkuNjI2SDIwOC45OTdjLTUuNzcxLDAtMTAuNDQ5LDQuNjc4LTEwLjQ0OSwxMC40NDlzNC42NzgsMTAuNDQ5LDEwLjQ0OSwxMC40NDlIMzI5LjE2DQoJCQkJYzUuNzcxLDAsMTAuNDQ5LTQuNjc4LDEwLjQ0OS0xMC40NDlTMzM0LjkzMSwzMzkuNjI2LDMyOS4xNiwzMzkuNjI2eiIvPg0KCQk8L2c+DQoJPC9nPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPC9zdmc+DQo=",width:"96",height:"96"}}),t._v(" "),n("strong",[t._v(t._s(t.t("mediadc","No tasks yet. Create a new one!")))])])])}),[],!1,null,"3b58d82a",null).exports},mixins:[c.a],props:{rootTitle:{type:String,required:!0},loading:{type:Boolean,required:!0}},data:function(){return{updating:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?z(Object(n),!0).forEach((function(e){O(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(o.c)(["settings","tasks"])),beforeMount:function(){this.getContent()},methods:{getContent:function(){var t=this;return b(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.$emit("update:loading",!0),t.getTasks();case 2:case"end":return e.stop()}}),e)})))()},getTasks:function(){var t=this;return b(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.a.get(Object(r.generateUrl)("/apps/mediadc/api/v1/tasks")).then((function(e){t.$store.dispatch("setTasks",e.data),t.$emit("update:loading",!1)}));case 1:case"end":return e.stop()}}),e)})))()}}},I=s(456),Q={insert:"head",singleton:!1},S=(h()(I.a,Q),I.a.locals,Object(y.a)(E,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loading?t._e():n("div",{staticClass:"container"},[n("div",{staticClass:"heading"},[n("h1",[t._v(t._s(t.rootTitle))]),t._v(" "),n("p",[t._v("\n\t\t\t"+t._s(t.t("mediadc_collector_welcome","Welcome to Media Duplicate Collector (MediaDC). Here you can manage your duplicate collection tasks and see the history of previous finished tasks."))+"\n\t\t")])]),t._v(" "),n("div",{staticClass:"mediadc-row"},[n("TasksNew"),t._v(" "),n("TasksList")],1)])}),[],!1,null,"4f1fe312",null));n.default=S.exports}}]);
//# sourceMappingURL=mediadc-5.js.map?v=51b41dde7235439b4728