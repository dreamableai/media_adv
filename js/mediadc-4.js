(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{242:function(e,n,i){"use strict";var a=i(378),s=i(0),r=i.n(s),o=[t("mediadc","Photos"),t("mediadc","Videos"),t("mediadc","Photos and Videos")];n.a={methods:{formatBytes:a.a,parseUnixTimestamp:function(t){return r.a.unix(Number(t)).format("YYYY-MM-DD HH:mm:ss")},getStatusBadge:function(t){return null==t?"":""!==t.errors?"error":0===Number(t.py_pid)&&0===Number(t.finished_time)&&Number(t.updated_time)>0&&Number(t.files_scanned)>0?"terminated":Number(t.py_pid)>0?r()().unix()>Number(t.updated_time)+24?"error":"running":Number(t.finished_time)>0&&0===Number(t.py_pid)?"finished":"pending"},parseTargetMtype:function(t){if(t)try{return o[Number(JSON.parse(t.collector_settings).target_mtype)]}catch(t){return""}return""}}}},378:function(t,e,n){"use strict";n.d(e,"d",(function(){return A})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return d})),n.d(e,"a",(function(){return c}));var i=n(12),a=n(21),s=n(22),r=n.n(s);function o(t,e,n,i,a,s,r){try{var o=t[s](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,a)}
/**
 * @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>
 * @copyright 2021 Alexander Piskun <bigcat88@icloud.com>
 *
 * @author Andrey Borysenko <andrey18106x@gmail.com>
 *
 * @license GNU AGPL version 3 or any later version
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 *
 */
var l=function(t){return window.DOMParser?(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("oc:fileid")[0].innerHTML:-1},d=function(t){return window.DOMParser?(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:getcontenttype")[0].innerHTML:null},A=function(){var t,e=(t=regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n="".concat(Object(i.generateRemoteUrl)("dav"),"/files/").concat(Object(a.getCurrentUser)().uid).concat(e),t.next=3,r()({method:"PROPFIND",url:n,data:'<?xml version="1.0"?>\n\t<d:propfind xmlns:d="DAV:" xmlns:oc="http://owncloud.org/ns"\n\t\t\t\txmlns:nc="http://nextcloud.org/ns"\n\t\t\t\txmlns:ocs="http://open-collaboration-services.org/ns">\n\t\t<d:prop>\n\t\t\t<oc:fileid />\n\t\t\t<d:getcontenttype />\n\t\t</d:prop>\n\t</d:propfind>',headers:{details:!0,depth:0}});case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(i,a){var s=t.apply(e,n);function r(t){o(s,i,a,r,l,"next",t)}function l(t){o(s,i,a,r,l,"throw",t)}r(void 0)}))});return function(t){return e.apply(this,arguments)}}(),c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===t)return"0 B";var n=1024,i=e<0?0:e,a=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],s=Math.floor(Math.log(t)/Math.log(n));return parseFloat((t/Math.pow(n,s)).toFixed(i))+" "+a[s]}},413:function(t,e,n){var i={"./af":243,"./af.js":243,"./ar":244,"./ar-dz":245,"./ar-dz.js":245,"./ar-kw":246,"./ar-kw.js":246,"./ar-ly":247,"./ar-ly.js":247,"./ar-ma":248,"./ar-ma.js":248,"./ar-sa":249,"./ar-sa.js":249,"./ar-tn":250,"./ar-tn.js":250,"./ar.js":244,"./az":251,"./az.js":251,"./be":252,"./be.js":252,"./bg":253,"./bg.js":253,"./bm":254,"./bm.js":254,"./bn":255,"./bn-bd":256,"./bn-bd.js":256,"./bn.js":255,"./bo":257,"./bo.js":257,"./br":258,"./br.js":258,"./bs":259,"./bs.js":259,"./ca":260,"./ca.js":260,"./cs":261,"./cs.js":261,"./cv":262,"./cv.js":262,"./cy":263,"./cy.js":263,"./da":264,"./da.js":264,"./de":265,"./de-at":266,"./de-at.js":266,"./de-ch":267,"./de-ch.js":267,"./de.js":265,"./dv":268,"./dv.js":268,"./el":269,"./el.js":269,"./en-au":270,"./en-au.js":270,"./en-ca":271,"./en-ca.js":271,"./en-gb":272,"./en-gb.js":272,"./en-ie":273,"./en-ie.js":273,"./en-il":274,"./en-il.js":274,"./en-in":275,"./en-in.js":275,"./en-nz":276,"./en-nz.js":276,"./en-sg":277,"./en-sg.js":277,"./eo":278,"./eo.js":278,"./es":279,"./es-do":280,"./es-do.js":280,"./es-mx":281,"./es-mx.js":281,"./es-us":282,"./es-us.js":282,"./es.js":279,"./et":283,"./et.js":283,"./eu":284,"./eu.js":284,"./fa":285,"./fa.js":285,"./fi":286,"./fi.js":286,"./fil":287,"./fil.js":287,"./fo":288,"./fo.js":288,"./fr":289,"./fr-ca":290,"./fr-ca.js":290,"./fr-ch":291,"./fr-ch.js":291,"./fr.js":289,"./fy":292,"./fy.js":292,"./ga":293,"./ga.js":293,"./gd":294,"./gd.js":294,"./gl":295,"./gl.js":295,"./gom-deva":296,"./gom-deva.js":296,"./gom-latn":297,"./gom-latn.js":297,"./gu":298,"./gu.js":298,"./he":299,"./he.js":299,"./hi":300,"./hi.js":300,"./hr":301,"./hr.js":301,"./hu":302,"./hu.js":302,"./hy-am":303,"./hy-am.js":303,"./id":304,"./id.js":304,"./is":305,"./is.js":305,"./it":306,"./it-ch":307,"./it-ch.js":307,"./it.js":306,"./ja":308,"./ja.js":308,"./jv":309,"./jv.js":309,"./ka":310,"./ka.js":310,"./kk":311,"./kk.js":311,"./km":312,"./km.js":312,"./kn":313,"./kn.js":313,"./ko":314,"./ko.js":314,"./ku":315,"./ku.js":315,"./ky":316,"./ky.js":316,"./lb":317,"./lb.js":317,"./lo":318,"./lo.js":318,"./lt":319,"./lt.js":319,"./lv":320,"./lv.js":320,"./me":321,"./me.js":321,"./mi":322,"./mi.js":322,"./mk":323,"./mk.js":323,"./ml":324,"./ml.js":324,"./mn":325,"./mn.js":325,"./mr":326,"./mr.js":326,"./ms":327,"./ms-my":328,"./ms-my.js":328,"./ms.js":327,"./mt":329,"./mt.js":329,"./my":330,"./my.js":330,"./nb":331,"./nb.js":331,"./ne":332,"./ne.js":332,"./nl":333,"./nl-be":334,"./nl-be.js":334,"./nl.js":333,"./nn":335,"./nn.js":335,"./oc-lnc":336,"./oc-lnc.js":336,"./pa-in":337,"./pa-in.js":337,"./pl":338,"./pl.js":338,"./pt":339,"./pt-br":340,"./pt-br.js":340,"./pt.js":339,"./ro":341,"./ro.js":341,"./ru":342,"./ru.js":342,"./sd":343,"./sd.js":343,"./se":344,"./se.js":344,"./si":345,"./si.js":345,"./sk":346,"./sk.js":346,"./sl":347,"./sl.js":347,"./sq":348,"./sq.js":348,"./sr":349,"./sr-cyrl":350,"./sr-cyrl.js":350,"./sr.js":349,"./ss":351,"./ss.js":351,"./sv":352,"./sv.js":352,"./sw":353,"./sw.js":353,"./ta":354,"./ta.js":354,"./te":355,"./te.js":355,"./tet":356,"./tet.js":356,"./tg":357,"./tg.js":357,"./th":358,"./th.js":358,"./tk":359,"./tk.js":359,"./tl-ph":360,"./tl-ph.js":360,"./tlh":361,"./tlh.js":361,"./tr":362,"./tr.js":362,"./tzl":363,"./tzl.js":363,"./tzm":364,"./tzm-latn":365,"./tzm-latn.js":365,"./tzm.js":364,"./ug-cn":366,"./ug-cn.js":366,"./uk":367,"./uk.js":367,"./ur":368,"./ur.js":368,"./uz":369,"./uz-latn":370,"./uz-latn.js":370,"./uz.js":369,"./vi":371,"./vi.js":371,"./x-pseudo":372,"./x-pseudo.js":372,"./yo":373,"./yo.js":373,"./zh-cn":374,"./zh-cn.js":374,"./zh-hk":375,"./zh-hk.js":375,"./zh-mo":376,"./zh-mo.js":376,"./zh-tw":377,"./zh-tw.js":377};function a(t){var e=s(t);return n(e)}function s(t){if(!n.o(i,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return i[t]}a.keys=function(){return Object.keys(i)},a.resolve=s,t.exports=a,a.id=413},457:function(t,e,n){"use strict";var i=n(66),a=n.n(i)()(!0);a.push([t.i,"\n.file-thumb[data-v-3b2be3bc] {\n\tdisplay: flex;\n\tborder-top-left-radius: 5px;\n\tborder-top-right-radius: 5px;\n}\nimg[data-v-3b2be3bc] {\n\twidth: 100%;\n\theight: auto;\n\tborder-top-left-radius: 5px;\n\tborder-top-right-radius: 5px;\n\tcursor: pointer;\n}\n.placeholder[data-v-3b2be3bc] {\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tcursor: pointer;\n\tborder-top-left-radius: 5px;\n\tborder-top-right-radius: 5px;\n}\nbody.theme--dark .placeholder[data-v-3b2be3bc] {\n\tbackground-color: #fff;\n}\n","",{version:3,sources:["webpack://src/components/details/DetailsFile.vue"],names:[],mappings:";AAuHA;CACA,aAAA;CACA,2BAAA;CACA,4BAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,2BAAA;CACA,4BAAA;CACA,eAAA;AACA;AAEA;CACA,WAAA;CACA,YAAA;CACA,aAAA;CACA,mBAAA;CACA,uBAAA;CACA,eAAA;CACA,2BAAA;CACA,4BAAA;AACA;AAEA;CACA,sBAAA;AACA",sourcesContent:['\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class="file-thumb" @click="openFile(file)">\n\t\t<img v-show="loaded"\n\t\t\t:key="file.filepath"\n\t\t\t:src="imageUrl"\n\t\t\t:alt="file.filename"\n\t\t\t:title="file.filepath"\n\t\t\t@load="onLoad">\n\t\t<div v-show="!loaded && file.filempart === \'video\'"\n\t\t\tclass="placeholder"\n\t\t\t:style="\'min-height: \' + detailsGridSize + \'px\'"\n\t\t\t:title="file.filepath">\n\t\t\t<svg width="50%"\n\t\t\t\theight="50%"\n\t\t\t\tversion="1.1"\n\t\t\t\tviewBox="-31 0 512 512"\n\t\t\t\txmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m440.59 206.68h-341.17l327.7-94.93c2.5469-0.73828 4.6953-2.4609 5.9766-4.7812 1.2812-2.3242 1.5859-5.0586 0.84766-7.6055l-17.148-59.199c-6.8516-23.645-28.867-40.16-53.539-40.16-5.1992 0-10.379 0.73828-15.402 2.1914l-307.68 89.129c-14.23 4.1211-26.023 13.582-33.215 26.633-7.1875 13.051-8.875 28.078-4.7539 42.305l16.754 57.836v238.25c0 30.688 24.965 55.652 55.648 55.652h120.16c5.5234 0 10-4.4766 10-10s-4.4766-10-10-10h-120.16c-19.66 0-35.652-15.992-35.652-35.652v-136.09h391.63v136.09c2.1e-4 19.66-15.992 35.652-35.652 35.652h-120.16c-5.5195 0-10 4.4766-10 10s4.4805 10 10 10h120.16c30.688 0 55.652-24.965 55.652-55.652v-239.67c0-5.5234-4.4766-10-10-10zm-176.33 93.586 42.488-73.586h55.262l-42.484 73.586zm-78.359 0 42.488-73.586h55.262l-42.484 73.586zm-78.355 0 42.484-73.586h55.266l-42.488 73.586zm37.18-129.46-71.148-68.336 53.309-15.441c0.375 0.54688 0.8125 1.0625 1.3125 1.543l71.148 68.336-53.309 15.441c-0.375-0.54688-0.81641-1.0664-1.3125-1.543zm134-125.84 71.148 68.336-53.309 15.441c-0.375-0.54688-0.8125-1.0664-1.3125-1.543l-71.148-68.336 53.309-15.441c0.375 0.54688 0.8125 1.0625 1.3125 1.543zm-75.266 21.805 71.148 68.332-53.309 15.445c-0.375-0.54687-0.8125-1.0664-1.3125-1.543l-71.148-68.336 53.309-15.441c0.37891 0.54297 0.81641 1.0625 1.3125 1.543zm149.96-45.367c3.2109-0.92969 6.5195-1.4023 9.8359-1.4023 15.824 0 29.938 10.578 34.328 25.727l14.367 49.59-40.121 11.621c-0.3789-0.54688-0.8164-1.0625-1.3164-1.543l-71.145-68.332zm-328.94 106.2c4.6094-8.3711 12.16-14.434 21.262-17.07l5.875-1.7031c0.37891 0.54688 0.81641 1.0664 1.3125 1.543l71.148 68.336-88.293 25.578-14.367-49.59c-2.6367-9.0976-1.5469-18.719 3.0625-27.094zm14.48 99.074h87.973l-42.484 73.586h-45.488zm303.66 73.586 42.484-73.586h45.488v73.586z" />\n\t\t\t\t<path d="m303.92 405.11c0-3.5742-1.9062-6.875-5-8.6602l-87.855-50.723c-3.0938-1.7852-6.9062-1.7852-10 0-3.0938 1.7852-5 5.0859-5 8.6602v101.45c0 3.5703 1.9062 6.8711 5 8.6562 1.5469 0.89453 3.2734 1.3438 5 1.3438 1.7266 0 3.4531-0.44922 5-1.3438l87.855-50.719c3.0938-1.7852 5-5.0859 5-8.6602zm-87.855 33.402v-66.805l57.855 33.402z" />\n\t\t\t\t<path d="m234.77 492c-5.5078 0-10 4.4922-10 10s4.4922 10 10 10c5.5117 0 10-4.4922 10-10s-4.4883-10-10-10z" />\n\t\t\t</svg>\n\t\t</div>\n\t\t<div v-show="!loaded && file.filempart === \'image\'"\n\t\t\tclass="placeholder"\n\t\t\t:style="\'min-height: \' + detailsGridSize + \'px\'">\n\t\t\t<svg width="50%"\n\t\t\t\tenable-background="new 0 0 512 512"\n\t\t\t\tversion="1.1"\n\t\t\t\tviewBox="0 0 512 512"\n\t\t\t\txml:space="preserve"\n\t\t\t\txmlns="http://www.w3.org/2000/svg">\n\t\t\t\t<path d="m446.58 0h-381.15c-36.076 0-65.425 29.35-65.425 65.426v381.15c0 36.075 29.349 65.425 65.425 65.425h381.15c36.076 0 65.425-29.35 65.425-65.426v-381.15c0-36.076-29.349-65.426-65.425-65.426zm35.267 446.58c0 19.447-15.821 35.267-35.267 35.267h-381.15c-19.447 0-35.268-15.821-35.268-35.267v-55.007l99.255-84.451c3.622-3.082 8.906-3.111 12.562-0.075l62.174 51.628c5.995 4.977 14.795 4.569 20.304-0.946l147.73-147.95c2.67-2.675 5.783-2.935 7.408-2.852 1.62 0.083 4.695 0.661 7.078 3.596l95.176 117.19v118.87zm0-166.71-71.766-88.366c-7.117-8.764-17.666-14.122-28.942-14.701-11.268-0.57-22.317 3.672-30.294 11.662l-138.01 138.22-51.59-42.839c-14.959-12.422-36.563-12.293-51.373 0.308l-79.712 67.822v-286.55c0-19.447 15.821-35.268 35.268-35.268h381.15c19.447 0 35.267 15.821 35.267 35.268v214.44z" />\n\t\t\t\t<path d="m161.17 62.995c-40.095 0-72.713 32.62-72.713 72.713 0 40.094 32.619 72.713 72.713 72.713s72.713-32.619 72.713-72.713-32.618-72.713-72.713-72.713zm0 115.27c-23.466 0-42.556-19.091-42.556-42.556 0-23.466 19.09-42.556 42.556-42.556s42.556 19.091 42.556 42.556-19.09 42.556-42.556 42.556z" />\n\t\t\t</svg>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { generateRemoteUrl } from \'@nextcloud/router\'\nimport { mapGetters } from \'vuex\'\nimport { getCurrentUser } from \'@nextcloud/auth\'\n\nexport default {\n\tname: \'DetailsFile\',\n\tprops: {\n\t\tfile: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t\tfiles: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tloaded: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\timageUrl() {\n\t\t\treturn generateRemoteUrl(`dav/files${this.file.filepath.replace(\'files/\', \'\')}`)\n\t\t},\n\t\t...mapGetters([\n\t\t\t\'detailsGridSize\',\n\t\t]),\n\t},\n\tmethods: {\n\t\topenFile(file) {\n\t\t\tconst filesList = this.files.map(file => ({\n\t\t\t\tbasename: file.filename,\n\t\t\t\tfileid: file.fileid,\n\t\t\t\tfilename: file.filepath.replace(`/${getCurrentUser().uid}/files`, \'\'),\n\t\t\t\tgetcontentlength: file.filesize,\n\t\t\t\tgetcontenttype: file.filemtype,\n\t\t\t\tmime: file.filemtype,\n\t\t\t\tsize: file.filesize,\n\t\t\t}))\n\t\t\tOCA.Viewer.open({\n\t\t\t\tpath: file.filepath.replace(`/${getCurrentUser().uid}/files`, \'\'),\n\t\t\t\tlist: filesList.map(file => ({\n\t\t\t\t\t...file,\n\t\t\t\t\tlist: filesList,\n\t\t\t\t})),\n\t\t\t})\n\t\t},\n\t\tonLoad() {\n\t\t\tconsole.debug(\'[DetailsFile] loaded\')\n\t\t\tthis.loaded = true\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.file-thumb {\n\tdisplay: flex;\n\tborder-top-left-radius: 5px;\n\tborder-top-right-radius: 5px;\n}\n\nimg {\n\twidth: 100%;\n\theight: auto;\n\tborder-top-left-radius: 5px;\n\tborder-top-right-radius: 5px;\n\tcursor: pointer;\n}\n\n.placeholder {\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tcursor: pointer;\n\tborder-top-left-radius: 5px;\n\tborder-top-right-radius: 5px;\n}\n\nbody.theme--dark .placeholder {\n\tbackground-color: #fff;\n}\n</style>\n'],sourceRoot:""}]),e.a=a},458:function(t,e,n){"use strict";var i=n(66),a=n.n(i)()(!0);a.push([t.i,"\n.details-group[data-v-b0be6cc8] {\n\tborder-top: 1px solid #dadada;\n\tborder-bottom: 1px solid #dadada;\n\tmargin: 10px 0;\n}\nbody.theme--dark .details-group[data-v-b0be6cc8] {\n\tborder-color: #717171;\n}\n.details-group-files[data-v-b0be6cc8] {\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tjustify-content: center;\n\tmax-height: 70vh;\n\toverflow-y: scroll;\n}\n.file[data-v-b0be6cc8] {\n\tdisplay: flex;\n\theight: 100%;\n\tflex-direction: column;\n\tjustify-content: space-between;\n\twidth: 192px;\n\tborder-radius: 5px;\n\tborder: 1px solid #dadada;\n\ttransition: box-shadow .3s;\n\tmargin: 10px;\n}\nbody.theme--dark .file[data-v-b0be6cc8] {\n\tborder-color: #717171;\n}\n@media (max-width: 540px) {\n.file[data-v-b0be6cc8] {\n\t\tmax-width: 192px;\n}\n.pagination[data-v-b0be6cc8] {\n\t\ttext-align: center;\n}\n}\n.file[data-v-b0be6cc8]:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, .25);\n}\n.file-info[data-v-b0be6cc8] {\n\twidth: 100%;\n\tpadding: 5px 10px;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tbackground-color: #000;\n\ttext-align: center;\n\tborder-bottom-left-radius: 5px;\n\tborder-bottom-right-radius: 5px;\n\tcolor: #fff;\n}\n.filename[data-v-b0be6cc8] {\n\twidth: 100%;\n\toverflow-x: hidden;\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n}\n.delete-file-btn[data-v-b0be6cc8] {\n\tpadding: 20px;\n\tborder-radius: 50%;\n\twidth: 16px;\n\theight: 16px;\n\tcursor: pointer;\n\tbackground-image: var(--icon-delete-fff);\n}\n.delete-file-btn[data-v-b0be6cc8]:hover {\n\tbackground-color: #eee;\n}\n.delete-file-btn[data-v-b0be6cc8]:active {\n\tbackground-color: #ddd;\n}\nbody.theme--dark .delete-file-btn[data-v-b0be6cc8] {\n\tbackground-image: var(--icon-delete-000);\n}\n.delete-file-btn[data-v-b0be6cc8]:hover, body.theme--dark .delete-file-btn[data-v-b0be6cc8]:hover {\n\tbackground-image: var(--icon-delete-e9322d);\n}\n","",{version:3,sources:["webpack://src/components/details/DetailsGroupList.vue"],names:[],mappings:";AAyFA;CACA,6BAAA;CACA,gCAAA;CACA,cAAA;AACA;AAEA;CACA,qBAAA;AACA;AAEA;CACA,aAAA;CACA,eAAA;CACA,uBAAA;CACA,gBAAA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,YAAA;CACA,sBAAA;CACA,8BAAA;CACA,YAAA;CACA,kBAAA;CACA,yBAAA;CACA,0BAAA;CACA,YAAA;AACA;AAEA;CACA,qBAAA;AACA;AAEA;AACA;EACA,gBAAA;AACA;AAEA;EACA,kBAAA;AACA;AACA;AAEA;CACA,yCAAA;AACA;AAEA;CACA,WAAA;CACA,iBAAA;CACA,aAAA;CACA,sBAAA;CACA,mBAAA;CACA,sBAAA;CACA,kBAAA;CACA,8BAAA;CACA,+BAAA;CACA,WAAA;AACA;AAEA;CACA,WAAA;CACA,kBAAA;CACA,uBAAA;CACA,mBAAA;AACA;AAEA;CACA,aAAA;CACA,kBAAA;CACA,WAAA;CACA,YAAA;CACA,eAAA;CACA,wCAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,wCAAA;AACA;AAEA;CACA,2CAAA;AACA",sourcesContent:['\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div v-if="!loadingFiles" class="details-group">\n\t\t<div class="details-group-files">\n\t\t\t<div v-for="file in files"\n\t\t\t\t:key="file.fileid"\n\t\t\t\tclass="file"\n\t\t\t\t:style="\'width: \' + detailsGridSize + \'px; min-height: \' + detailsGridSize + \'px;\'">\n\t\t\t\t<DetailsFile :file="file" :files="files" />\n\t\t\t\t<div class="file-info">\n\t\t\t\t\t<span class="filename">{{ file.filename }}</span>\n\t\t\t\t\t<span class="owner">{{ file.fileowner }}</span>\n\t\t\t\t\t<span class="size">{{ formatBytes(Number(file.filesize)) }}</span>\n\t\t\t\t\t<span class="delete-file-btn icon-delete-white" @click="deleteGroupFile(file)" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div v-else>\n\t\t<span class="icon-loading" style="width: 20px; height: 20px; display: flex; margin: 20px auto;" />\n\t</div>\n</template>\n\n<script>\nimport axios from \'@nextcloud/axios\'\nimport { generateUrl } from \'@nextcloud/router\'\nimport Formats from \'../../mixins/Formats\'\nimport { mapGetters } from \'vuex\'\nimport DetailsFile from \'./DetailsFile\'\n\nexport default {\n\tname: \'DetailsGroupList\',\n\tcomponents: { DetailsFile },\n\tmixins: [Formats],\n\tprops: {\n\t\tfiles: {\n\t\t\ttype: Array,\n\t\t\trequired: true,\n\t\t},\n\t\tloadingFiles: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t\'detailsGridSize\',\n\t\t]),\n\t},\n\tmethods: {\n\t\tdeleteGroupFile(file) {\n\t\t\tif (confirm(t(\'mediadc\', \'Are you sure, you want delete this file?\'))) {\n\t\t\t\taxios.delete(generateUrl(`/apps/mediadc/api/v1/tasks/${file.taskId}/files/${file.detailId}/${file.fileid}`))\n\t\t\t\t\t.then(res => {\n\t\t\t\t\t\tconst files = this.files\n\t\t\t\t\t\tconst fileidIndex = files.findIndex(f => f.fileid === file.fileid)\n\t\t\t\t\t\tfiles.splice(fileidIndex, 1)\n\t\t\t\t\t\tthis.$emit(\'update:files\', files)\n\t\t\t\t\t\tthis.$store.dispatch(\'setTask\', res.data.task)\n\t\t\t\t\t})\n\t\t\t}\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.details-group {\n\tborder-top: 1px solid #dadada;\n\tborder-bottom: 1px solid #dadada;\n\tmargin: 10px 0;\n}\n\nbody.theme--dark .details-group {\n\tborder-color: #717171;\n}\n\n.details-group-files {\n\tdisplay: flex;\n\tflex-wrap: wrap;\n\tjustify-content: center;\n\tmax-height: 70vh;\n\toverflow-y: scroll;\n}\n\n.file {\n\tdisplay: flex;\n\theight: 100%;\n\tflex-direction: column;\n\tjustify-content: space-between;\n\twidth: 192px;\n\tborder-radius: 5px;\n\tborder: 1px solid #dadada;\n\ttransition: box-shadow .3s;\n\tmargin: 10px;\n}\n\nbody.theme--dark .file {\n\tborder-color: #717171;\n}\n\n@media (max-width: 540px) {\n\t.file {\n\t\tmax-width: 192px;\n\t}\n\n\t.pagination {\n\t\ttext-align: center;\n\t}\n}\n\n.file:hover {\n\tbox-shadow: 0 0 10px 0 rgba(0, 0, 0, .25);\n}\n\n.file-info {\n\twidth: 100%;\n\tpadding: 5px 10px;\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tbackground-color: #000;\n\ttext-align: center;\n\tborder-bottom-left-radius: 5px;\n\tborder-bottom-right-radius: 5px;\n\tcolor: #fff;\n}\n\n.filename {\n\twidth: 100%;\n\toverflow-x: hidden;\n\ttext-overflow: ellipsis;\n\twhite-space: nowrap;\n}\n\n.delete-file-btn {\n\tpadding: 20px;\n\tborder-radius: 50%;\n\twidth: 16px;\n\theight: 16px;\n\tcursor: pointer;\n\tbackground-image: var(--icon-delete-fff);\n}\n\n.delete-file-btn:hover {\n\tbackground-color: #eee;\n}\n\n.delete-file-btn:active {\n\tbackground-color: #ddd;\n}\n\nbody.theme--dark .delete-file-btn {\n\tbackground-image: var(--icon-delete-000);\n}\n\n.delete-file-btn:hover, body.theme--dark .delete-file-btn:hover {\n\tbackground-image: var(--icon-delete-e9322d);\n}\n</style>\n'],sourceRoot:""}]),e.a=a},459:function(t,e,n){"use strict";var i=n(66),a=n.n(i)()(!0);a.push([t.i,"\n.details-list-item[data-v-4156cb36] {\n\twidth: 100%;\n\tpadding: 10px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tflex-direction: column;\n}\n.details-list-item-title[data-v-4156cb36] {\n\tdisplay: flex;\n\talign-items: center;\n}\n.details-list-item-title .group-info[data-v-4156cb36] {\n\tcursor: pointer;\n}\n.details-list-item-title .group-info[data-v-4156cb36]:hover {\n\ttext-decoration: underline;\n}\n.pagination[data-v-4156cb36] {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin: 10px 0;\n}\n.pagination-button[data-v-4156cb36] {\n\tpadding: 20px;\n\tmargin: 0 5px;\n\twidth: 16px;\n\theight: 16px;\n\tcursor: pointer;\n\tborder-radius: 50%;\n\tuser-select: none;\n}\n.pagination-button[data-v-4156cb36]:hover {\n\tbackground-color: #eee;\n}\n.pagination-button[data-v-4156cb36]:active {\n\tbackground-color: #ddd;\n}\nbody.theme--dark .pagination-button[data-v-4156cb36]:hover {\n\tbackground-color: #727272;\n}\nbody.theme--dark .pagination-button[data-v-4156cb36]:active {\n\tbackground-color: #5b5b5b;\n}\n.open-details-btn[data-v-4156cb36] {\n\tdisplay: inline-flex;\n\twidth: 16px;\n\theight: 16px;\n}\n.delete-group-btn[data-v-4156cb36] {\n\tvisibility: hidden;\n\tcursor: pointer;\n\tmargin: 0 10px;\n}\n.details-list-item:hover .delete-group-btn[data-v-4156cb36] {\n\tvisibility: visible;\n}\n","",{version:3,sources:["webpack://src/components/details/DetailsListItem.vue"],names:[],mappings:";AAqKA;CACA,WAAA;CACA,aAAA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;CACA,sBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;AACA;AAEA;CACA,eAAA;AACA;AAEA;CACA,0BAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,cAAA;AACA;AAEA;CACA,aAAA;CACA,aAAA;CACA,WAAA;CACA,YAAA;CACA,eAAA;CACA,kBAAA;CACA,iBAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,yBAAA;AACA;AAEA;CACA,yBAAA;AACA;AAEA;CACA,oBAAA;CACA,WAAA;CACA,YAAA;AACA;AAEA;CACA,kBAAA;CACA,eAAA;CACA,cAAA;AACA;AAEA;CACA,mBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"details-list-item\">\n\t\t<div class=\"details-list-item-title\">\n\t\t\t<span class=\"icon-projects\" style=\"margin: 0 5px 0 0;\" />\n\t\t\t<span class=\"group-info\" @click=\"openDetailFiles(detail)\">\n\t\t\t\t{{ t('mediadc', 'Duplicate group') }} #{{ detail.id }} ({{ JSON.parse(detail.group_file_ids).length }}\n\t\t\t\t{{ t('mediadc', 'file(s)') }}{{ files.length > 0 ? ' - ' + formatBytes(getGroupFilesSize(files)) : '' }})\n\t\t\t</span>\n\t\t\t<span :class=\"!opened ? 'icon-triangle-s open-details-btn' : 'icon-triangle-n open-details-btn'\" />\n\t\t\t<span class=\"icon-delete delete-group-btn\" @click=\"deleteTaskDetail(detail)\" />\n\t\t</div>\n\t\t<div v-if=\"opened && JSON.parse(detail.group_file_ids).length > itemsPerPage\" class=\"pagination\">\n\t\t\t<span class=\"icon-view-previous pagination-button\"\n\t\t\t\t@click=\"openPrevDetailFiles(detail)\" />\n\t\t\t<span>{{ t('mediadc', 'Page:') }}&nbsp;</span>\n\t\t\t<span>{{ page + 1 }}/{{ Math.ceil(JSON.parse(detail.group_file_ids).length / itemsPerPage) }}</span>\n\t\t\t<span class=\"icon-view-next pagination-button\"\n\t\t\t\t@click=\"openNextDetailFiles(detail)\" />\n\t\t</div>\n\t\t<DetailsGroupList v-show=\"opened\" :files=\"files\" :loading-files=\"loadingFiles\" />\n\t</div>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { generateUrl } from '@nextcloud/router'\nimport DetailsGroupList from './DetailsGroupList'\nimport Formats from '../../mixins/Formats'\nimport { mapGetters } from 'vuex'\nimport { showError, showSuccess, showWarning } from '@nextcloud/dialogs'\n\nexport default {\n\tname: 'DetailsListItem',\n\tcomponents: { DetailsGroupList },\n\tmixins: [Formats],\n\tprops: {\n\t\tdetail: {\n\t\t\ttype: Object,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\topened: false,\n\t\t\tpage: 0,\n\t\t\ttotalPages: 0,\n\t\t\titemsPerPage: 10,\n\t\t\tloadingFiles: false,\n\t\t\tfiles: [],\n\t\t\tpaginatedFiles: {},\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'task',\n\t\t\t'details',\n\t\t]),\n\t},\n\tmethods: {\n\t\topenDetailFiles(detail) {\n\t\t\tif (!this.opened) {\n\t\t\t\tif (this.files.length === 0) {\n\t\t\t\t\tconst taskId = detail.task_id\n\t\t\t\t\tconst detailId = detail.id\n\t\t\t\t\tthis.loadingFiles = true\n\t\t\t\t\tthis.opened = true\n\t\t\t\t\tif (!(this.page in this.paginatedFiles)) {\n\t\t\t\t\t\tthis.loadFilesInfo(taskId, detailId)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.files = this.paginatedFiles[this.page]\n\t\t\t\t\t\tthis.loadingFiles = false\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.opened = true\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.opened = false\n\t\t\t}\n\t\t},\n\t\topenNextDetailFiles(detail) {\n\t\t\tif (this.page < Math.ceil(JSON.parse(detail.group_file_ids).length / this.itemsPerPage) - 1) {\n\t\t\t\tthis.page += 1\n\t\t\t\tconst taskId = detail.task_id\n\t\t\t\tconst detailId = detail.id\n\t\t\t\tthis.loadingFiles = true\n\t\t\t\tif (!(this.page in this.paginatedFiles)) {\n\t\t\t\t\tthis.loadFilesInfo(taskId, detailId)\n\t\t\t\t} else {\n\t\t\t\t\tthis.files = this.paginatedFiles[this.page]\n\t\t\t\t\tthis.loadingFiles = false\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'Last page reached!'))\n\t\t\t}\n\t\t},\n\t\topenPrevDetailFiles(detail) {\n\t\t\tif (this.page > 0) {\n\t\t\t\tthis.page -= 1\n\t\t\t\tconst taskId = detail.task_id\n\t\t\t\tconst detailId = detail.id\n\t\t\t\tthis.loadingFiles = true\n\t\t\t\tif (!(this.page in this.paginatedFiles)) {\n\t\t\t\t\tthis.loadFilesInfo(taskId, detailId)\n\t\t\t\t} else {\n\t\t\t\t\tthis.files = this.paginatedFiles[this.page]\n\t\t\t\t\tthis.loadingFiles = false\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'First page reached!'))\n\t\t\t}\n\t\t},\n\t\tloadFilesInfo(taskId, detailId) {\n\t\t\taxios.get(generateUrl(`/apps/mediadc/api/v1/tasks/${taskId}/files/${detailId}?limit=${this.itemsPerPage}&page=${this.page}`)).then(res => {\n\t\t\t\tthis.paginatedFiles[this.page] = res.data.map(file => ({\n\t\t\t\t\t...file,\n\t\t\t\t\ttaskId,\n\t\t\t\t\tdetailId,\n\t\t\t\t}))\n\t\t\t\tthis.files = this.paginatedFiles[this.page]\n\t\t\t\tthis.loadingFiles = false\n\t\t\t})\n\t\t},\n\t\tgetGroupFilesSize(groupFiles) {\n\t\t\treturn groupFiles.reduce((sum, file) => sum + file.filesize, 0)\n\t\t},\n\t\tdeleteTaskDetail(detail) {\n\t\t\tif (confirm(t('mediadc', 'Are you sure, you want remove this group without deleting files?'))) {\n\t\t\t\taxios.delete(generateUrl(`/apps/mediadc/api/v1/tasks/${detail.task_id}/detail/${detail.id}`)).then(res => {\n\t\t\t\t\tif (res.data.success) {\n\t\t\t\t\t\tthis.$store.dispatch('deleteDetail', detail)\n\t\t\t\t\t\tshowSuccess(t('mediadc', 'Duplicate group succesffully removed'))\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshowError(t('mediadc', 'Some error occured while deleting duplicate group'))\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.details-list-item {\n\twidth: 100%;\n\tpadding: 10px;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tflex-direction: column;\n}\n\n.details-list-item-title {\n\tdisplay: flex;\n\talign-items: center;\n}\n\n.details-list-item-title .group-info {\n\tcursor: pointer;\n}\n\n.details-list-item-title .group-info:hover {\n\ttext-decoration: underline;\n}\n\n.pagination {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin: 10px 0;\n}\n\n.pagination-button {\n\tpadding: 20px;\n\tmargin: 0 5px;\n\twidth: 16px;\n\theight: 16px;\n\tcursor: pointer;\n\tborder-radius: 50%;\n\tuser-select: none;\n}\n\n.pagination-button:hover {\n\tbackground-color: #eee;\n}\n\n.pagination-button:active {\n\tbackground-color: #ddd;\n}\n\nbody.theme--dark .pagination-button:hover {\n\tbackground-color: #727272;\n}\n\nbody.theme--dark .pagination-button:active {\n\tbackground-color: #5b5b5b;\n}\n\n.open-details-btn {\n\tdisplay: inline-flex;\n\twidth: 16px;\n\theight: 16px;\n}\n\n.delete-group-btn {\n\tvisibility: hidden;\n\tcursor: pointer;\n\tmargin: 0 10px;\n}\n\n.details-list-item:hover .delete-group-btn {\n\tvisibility: visible;\n}\n</style>\n"],sourceRoot:""}]),e.a=a},460:function(t,e,n){"use strict";var i=n(66),a=n.n(i)()(!0);a.push([t.i,"\n.task-details[data-v-5a5d6470] {\n\twidth: 100%;\n\tpadding: 10px 20px 20px;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tmax-height: 100vh;\n\toverflow-y: scroll;\n\tmargin: 0 auto;\n}\n.task-details-heading[data-v-5a5d6470] {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n.pagination[data-v-5a5d6470] {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin: 10px 0;\n}\n.pagination-button[data-v-5a5d6470] {\n\tpadding: 20px;\n\tmargin: 0 5px;\n\twidth: 16px;\n\theight: 16px;\n\tcursor: pointer;\n\tborder-radius: 50%;\n\tuser-select: none;\n}\n.pagination-button[data-v-5a5d6470]:hover {\n\tbackground-color: #eee;\n}\n.pagination-button[data-v-5a5d6470]:active {\n\tbackground-color: #ddd;\n}\nbody.theme--dark .pagination-button[data-v-5a5d6470]:hover {\n\tbackground-color: #727272;\n}\nbody.theme--dark .pagination-button[data-v-5a5d6470]:active {\n\tbackground-color: #5b5b5b;\n}\nbody.theme--dark .task-details[data-v-5a5d6470] {\n\tborder-color: #717171;\n}\n.task-details-row[data-v-5a5d6470] {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tborder: 1px solid #dedede;\n\tborder-radius: 5px;\n\tmargin-bottom: 5px;\n\ttransition: height .3s;\n}\nbody.theme--dark .task-details-row[data-v-5a5d6470] {\n\tborder-color: #717171;\n}\n","",{version:3,sources:["webpack://src/components/details/DetailsList.vue"],names:[],mappings:";AAgHA;CACA,WAAA;CACA,uBAAA;CACA,yBAAA;CACA,kBAAA;CACA,iBAAA;CACA,kBAAA;CACA,cAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,cAAA;AACA;AAEA;CACA,aAAA;CACA,aAAA;CACA,WAAA;CACA,YAAA;CACA,eAAA;CACA,kBAAA;CACA,iBAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,yBAAA;AACA;AAEA;CACA,yBAAA;AACA;AAEA;CACA,qBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;CACA,8BAAA;CACA,yBAAA;CACA,kBAAA;CACA,kBAAA;CACA,sBAAA;AACA;AAEA;CACA,qBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div class=\"task-details\">\n\t\t<div class=\"task-details-heading\">\n\t\t\t<h3>\n\t\t\t\t{{ t('mediadc', 'Duplicates list') }}\n\t\t\t\t<span v-if=\"getStatusBadge(task) === 'finished'\">\n\t\t\t\t\t- {{ details.length }} {{ t('mediadc', 'group(s)') }}\n\t\t\t\t\t({{ filestotal }} {{ t('mediadc', 'file(s)') }} - {{ formatBytes(filessize) }})\n\t\t\t\t</span>\n\t\t\t</h3>\n\t\t\t<div v-if=\"details.length > itemsPerPage\" class=\"pagination\">\n\t\t\t\t<span class=\"icon-view-previous pagination-button\"\n\t\t\t\t\t@click=\"prevGroupsPage()\" />\n\t\t\t\t<span>{{ t('mediadc', 'Page:') }}&nbsp;</span>\n\t\t\t\t<span>{{ page + 1 }}/{{ Math.ceil(details.length / itemsPerPage) }}</span>\n\t\t\t\t<span class=\"icon-view-next pagination-button\"\n\t\t\t\t\t@click=\"nextGroupsPage()\" />\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-if=\"details.length > 0\">\n\t\t\t<div v-for=\"detail in paginatedDetails[page]\"\n\t\t\t\tv-show=\"JSON.parse(detail.group_file_ids).length > 1\"\n\t\t\t\t:key=\"detail.id\"\n\t\t\t\tclass=\"task-details-row\">\n\t\t\t\t<DetailsListItem :detail=\"detail\" />\n\t\t\t</div>\n\t\t</div>\n\t\t<div v-else>\n\t\t\t<strong>{{ t('mediadc', 'No duplicates found.') }}</strong>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { showWarning } from '@nextcloud/dialogs'\nimport { mapGetters } from 'vuex'\nimport Formats from '../../mixins/Formats'\nimport DetailsListItem from './DetailsListItem'\n\nexport default {\n\tname: 'DetailsList',\n\tcomponents: { DetailsListItem },\n\tmixins: [Formats],\n\tprops: {\n\t\tfilessize: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tfilestotal: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tpage: 0,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'task',\n\t\t\t'details',\n\t\t\t'paginatedDetails',\n\t\t\t'itemsPerPage',\n\t\t]),\n\t},\n\tbeforeMount() {\n\t\tthis.$emit('update:loading', false)\n\t},\n\tmethods: {\n\t\tprevGroupsPage() {\n\t\t\tif (this.page > 0) {\n\t\t\t\tthis.page -= 1\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'First page reached!'))\n\t\t\t}\n\t\t},\n\t\tnextGroupsPage() {\n\t\t\tif (this.page < Math.ceil(this.details.length / this.itemsPerPage) - 1) {\n\t\t\t\tthis.page += 1\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'Last page reached!'))\n\t\t\t}\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.task-details {\n\twidth: 100%;\n\tpadding: 10px 20px 20px;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tmax-height: 100vh;\n\toverflow-y: scroll;\n\tmargin: 0 auto;\n}\n\n.task-details-heading {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n}\n\n.pagination {\n\tdisplay: flex;\n\talign-items: center;\n\tmargin: 10px 0;\n}\n\n.pagination-button {\n\tpadding: 20px;\n\tmargin: 0 5px;\n\twidth: 16px;\n\theight: 16px;\n\tcursor: pointer;\n\tborder-radius: 50%;\n\tuser-select: none;\n}\n\n.pagination-button:hover {\n\tbackground-color: #eee;\n}\n\n.pagination-button:active {\n\tbackground-color: #ddd;\n}\n\nbody.theme--dark .pagination-button:hover {\n\tbackground-color: #727272;\n}\n\nbody.theme--dark .pagination-button:active {\n\tbackground-color: #5b5b5b;\n}\n\nbody.theme--dark .task-details {\n\tborder-color: #717171;\n}\n\n.task-details-row {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: space-between;\n\tborder: 1px solid #dedede;\n\tborder-radius: 5px;\n\tmargin-bottom: 5px;\n\ttransition: height .3s;\n}\n\nbody.theme--dark .task-details-row {\n\tborder-color: #717171;\n}\n</style>\n"],sourceRoot:""}]),e.a=a},461:function(t,e,n){"use strict";var i=n(66),a=n.n(i)()(!0);a.push([t.i,"\n.container[data-v-7ead2322] {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n\tmax-height: 100%;\n}\nh2[data-v-7ead2322] {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n\twidth: 100%;\n\tmargin: 20px auto;\n\ttext-align: center;\n}\n.collapse-task-status-btn[data-v-7ead2322] {\n\tdisplay: inline-flex;\n\tcursor: pointer;\n\twidth: 16px;\n\theight: 16px;\n\tmargin: 0 10px;\n\tpadding: 20px;\n\tborder-radius: 50%;\n\tuser-select: none;\n}\n.task-details-heading p[data-v-7ead2322] {\n\ttext-align: center;\n}\n.details-row[data-v-7ead2322] {\n\tdisplay: flex;\n\tmargin: 0 10px 20px;\n}\n@media (max-width: 767px) {\n.details-row[data-v-7ead2322] {\n\t\tflex-wrap: wrap;\n}\n.task-details-heading[data-v-7ead2322] {\n\t\tflex-direction: column;\n}\n}\n.task-status-row[data-v-7ead2322] {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tflex-wrap: wrap;\n}\n.task-status[data-v-7ead2322] {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tmargin: 20px;\n\tpadding: 10px;\n}\n.actions-menu-button[data-v-7ead2322] {\n\tpadding: 20px;\n\tborder-radius: 50%;\n\tcursor: pointer;\n\tuser-select: none;\n}\n.actions-menu-button[data-v-7ead2322]:hover, .collapse-task-status-btn[data-v-7ead2322]:hover {\n\tbackground-color: #eee;\n}\n.actions-menu-button[data-v-7ead2322]:active, .collapse-task-status-btn[data-v-7ead2322]:active {\n\tbackground-color: #ddd;\n}\nbody.theme--dark .actions-menu-button[data-v-7ead2322]:hover, body.theme--dark .collapse-task-status-btn[data-v-7ead2322]:hover {\n\tbackground-color: #727272;\n}\nbody.theme--dark .actions-menu-button[data-v-7ead2322]:active, body.theme--dark .collapse-task-status-btn[data-v-7ead2322]:active {\n\tbackground-color: #5b5b5b;\n}\nbody.theme--dark .task-status[data-v-7ead2322], body.theme--dark .task-info[data-v-7ead2322] {\n\tborder-color: #717171;\n}\n.task-owner[data-v-7ead2322] {\n\tcolor: #585858;\n}\nbody.theme--dark .task-owner[data-v-7ead2322] {\n\tcolor: #a9a8a8;\n}\n.task-info[data-v-7ead2322] {\n\tmargin: 20px 0;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tpadding: 10px 20px;\n\theight: 100%;\n\tmax-height: 94px;\n\tmax-width: 300px;\n\toverflow-y: scroll;\n}\n@media (max-width: 767px) {\n.task-status[data-v-7ead2322] {\n\t\tflex-direction: column;\n}\n.task-info[data-v-7ead2322] {\n\t\tmax-width: 100%;\n\t\tmargin: 0;\n}\n}\n.task-info h3[data-v-7ead2322] {\n\tmargin: 0 0 5px 0;\n}\n.target-directory-row[data-v-7ead2322] {\n\toverflow-x: scroll;\n\twhite-space: nowrap;\n}\n.badge[data-v-7ead2322] {\n\tdisplay: inline-flex;\n\tpadding: 0 10px;\n\tbackground-color: #eee;\n\tborder-radius: 20px;\n\tmargin-right: 20px;\n}\n@media (max-width: 540px) {\n.task-status-row[data-v-7ead2322] {\n\t\tflex-direction: column;\n\t\tmargin: 20px 0;\n}\n.badge[data-v-7ead2322] {\n\t\tmargin-right: 0;\n\t\tmargin-top: 10px;\n\t\tmargin-bottom: 10px;\n}\n}\n.badge.finished[data-v-7ead2322] {\n\tbackground-color: #49b382;\n\tcolor: #fff;\n}\n.badge.running[data-v-7ead2322], .badge.pending[data-v-7ead2322] {\n\tbackground-color: #dadada;\n\tcolor: #000;\n}\n.badge.error[data-v-7ead2322] {\n\tbackground-color: #bd3f3f;\n\tcolor: #fff;\n}\n.badge.terminated[data-v-7ead2322] {\n\tbackground-color: #f17b1b;\n\tcolor: #fff;\n}\n.errors[data-v-7ead2322] {\n\tmargin: 20px;\n\tborder: 1px solid #bd3f3f;\n\tborder-radius: 5px;\n\tpadding: 10px;\n\tmax-height: 100vh;\n\toverflow-y: scroll;\n}\n.error-row[data-v-7ead2322] {\n\tborder-bottom: 1px solid #bd3f3f;\n\tpadding: 5px 0;\n\tmax-height: 100%;\n\toverflow-y: scroll;\n}\n","",{version:3,sources:["webpack://src/views/CollectorDetails.vue"],names:[],mappings:";AAiRA;CACA,eAAA;CACA,WAAA;CACA,iBAAA;CACA,cAAA;CACA,gBAAA;AACA;AAEA;CACA,oBAAA;CACA,mBAAA;CACA,uBAAA;CACA,WAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,oBAAA;CACA,eAAA;CACA,WAAA;CACA,YAAA;CACA,cAAA;CACA,aAAA;CACA,kBAAA;CACA,iBAAA;AACA;AAEA;CACA,kBAAA;AACA;AAEA;CACA,aAAA;CACA,mBAAA;AACA;AAEA;AACA;EACA,eAAA;AACA;AACA;EACA,sBAAA;AACA;AACA;AAEA;CACA,aAAA;CACA,uBAAA;CACA,mBAAA;CACA,eAAA;AACA;AAEA;CACA,oBAAA;CACA,mBAAA;CACA,yBAAA;CACA,kBAAA;CACA,YAAA;CACA,aAAA;AACA;AAEA;CACA,aAAA;CACA,kBAAA;CACA,eAAA;CACA,iBAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,sBAAA;AACA;AAEA;CACA,yBAAA;AACA;AAEA;CACA,yBAAA;AACA;AAEA;CACA,qBAAA;AACA;AAEA;CACA,cAAA;AACA;AAEA;CACA,cAAA;AACA;AAEA;CACA,cAAA;CACA,yBAAA;CACA,kBAAA;CACA,kBAAA;CACA,YAAA;CACA,gBAAA;CACA,gBAAA;CACA,kBAAA;AACA;AAEA;AACA;EACA,sBAAA;AACA;AAEA;EACA,eAAA;EACA,SAAA;AACA;AACA;AAEA;CACA,iBAAA;AACA;AAEA;CACA,kBAAA;CACA,mBAAA;AACA;AAEA;CACA,oBAAA;CACA,eAAA;CACA,sBAAA;CACA,mBAAA;CACA,kBAAA;AACA;AAEA;AACA;EACA,sBAAA;EACA,cAAA;AACA;AAEA;EACA,eAAA;EACA,gBAAA;EACA,mBAAA;AACA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,yBAAA;CACA,WAAA;AACA;AAEA;CACA,YAAA;CACA,yBAAA;CACA,kBAAA;CACA,aAAA;CACA,iBAAA;CACA,kBAAA;AACA;AAEA;CACA,gCAAA;CACA,cAAA;CACA,gBAAA;CACA,kBAAA;AACA",sourcesContent:["\x3c!--\n - @copyright 2021 Andrey Borysenko <andrey18106x@gmail.com>\n - @copyright 2021 Alexander Piskun <bigcat88@icloud.com>\n -\n - @author Andrey Borysenko <andrey18106x@gmail.com>\n -\n - @license GNU AGPL version 3 or any later version\n -\n - This program is free software: you can redistribute it and/or modify\n - it under the terms of the GNU Affero General Public License as\n - published by the Free Software Foundation, either version 3 of the\n - License, or (at your option) any later version.\n -\n - This program is distributed in the hope that it will be useful,\n - but WITHOUT ANY WARRANTY; without even the implied warranty of\n - MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the\n - GNU Affero General Public License for more details.\n -\n - You should have received a copy of the GNU Affero General Public License\n - along with this program. If not, see <http://www.gnu.org/licenses/>.\n -\n --\x3e\n\n<template>\n\t<div v-if=\"!loading\" class=\"container\">\n\t\t<div class=\"task-details\">\n\t\t\t<div class=\"task-details-heading\">\n\t\t\t\t<h2>\n\t\t\t\t\t{{ rootTitle }}\n\t\t\t\t\t<span :class=\"!collapsedStatus\n\t\t\t\t\t\t\t? 'icon-triangle-n collapse-task-status-btn'\n\t\t\t\t\t\t\t: 'icon-triangle-s collapse-task-status-btn'\"\n\t\t\t\t\t\t@click=\"collapseTaskStatus\" />\n\t\t\t\t</h2>\n\t\t\t\t<div v-show=\"!collapsedStatus\" class=\"task-details-description\">\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{{ t('mediadc', 'Here you can view task details, manage task (stop or restart), ' +\n\t\t\t\t\t\t\t'delete found duplicated photos and videos.') }}\n\t\t\t\t\t</p>\n\t\t\t\t\t<p>\n\t\t\t\t\t\t{{ t('mediadc', 'Deleted files are placed in the trash, so that they can be restored in case of need.') }}\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-show=\"!collapsedStatus\" class=\"task-status-row\">\n\t\t\t\t<div class=\"task-status\">\n\t\t\t\t\t<span :class=\"'badge ' + getStatusBadge(task)\">{{ getStatusBadge(task) }}</span>\n\t\t\t\t\t<div style=\"display: flex; flex-direction: column;\">\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t<b>{{ t('mediadc', 'Task #') }}{{ parseTargetMtype(task) }}</b> {{ task.files_scanned !== task.files_total ? `${task.files_scanned}/` : '' }}{{ task.files_total }} file(s)\n\t\t\t\t\t\t\t({{ formatBytes(Number(task.files_total_size)) }})\n\t\t\t\t\t\t\t<br>\n\t\t\t\t\t\t\t<b>{{ t('mediadc', 'Deleted: ') }} </b>\n\t\t\t\t\t\t\t{{ task.deleted_files_count }} {{ t('mediadc', 'file(s)') }}\n\t\t\t\t\t\t\t({{ formatBytes(Number(task.deleted_files_size)) }})\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ t('mediadc', 'by') }} <span class=\"task-owner\">{{ task.owner + ' ' }}</span>\n\t\t\t\t\t\t\t({{ parseUnixTimestamp(task.created_time) }}{{ Number(task.finished_time) > 0 ? ' - ' + parseUnixTimestamp(task.finished_time) : '' }})\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"app-content-list-menu\" style=\"margin: 0 0 0 10px; position: relative;\">\n\t\t\t\t\t\t<div class=\"icon-more actions-menu-button\" @click=\"openActionsPopup\" />\n\t\t\t\t\t\t<div :class=\"actionsOpened ? 'popovermenu open' : 'popovermenu'\"\n\t\t\t\t\t\t\tstyle=\"right: -1px;\">\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a class=\"icon-history\" @click=\"restartTask(task)\">\n\t\t\t\t\t\t\t\t\t\t<span>{{ t('mediadc', 'Restart') }}</span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a class=\"icon-pause\" @click=\"terminateTask(task)\">\n\t\t\t\t\t\t\t\t\t\t<span>{{ t('mediadc', 'Stop') }}</span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<a class=\"icon-delete\" @click=\"deleteTask(task)\">\n\t\t\t\t\t\t\t\t\t\t<span>{{ t('mediadc', 'Delete') }}</span>\n\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"task-info\">\n\t\t\t\t\t<h3>{{ t('mediadc', 'Target directories') }}</h3>\n\t\t\t\t\t<div class=\"target-directories-list\">\n\t\t\t\t\t\t<div v-for=\"dir in taskInfo\" :key=\"dir.fileid\" class=\"target-directory-row\">\n\t\t\t\t\t\t\t<b>[{{ dir.fileowner }}] {{ dir.filepath.replace('/admin/files', '') }}</b> ({{ formatBytes(dir.filesize) }})\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div v-if=\"isValidUser\" class=\"details-row\">\n\t\t\t\t<DetailsList :filessize=\"filessize\" :filestotal=\"filestotal\" />\n\t\t\t</div>\n\t\t\t<div v-else>\n\t\t\t\t<p style=\"text-align: center;\">\n\t\t\t\t\t<b>{{ t('mediadc', 'You are not allowed to manage other user\\'s tasks.') }}</b>\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t\t<div v-if=\"task.errors !== undefined && task.errors.length > 0\" class=\"errors\">\n\t\t\t\t<h3>{{ t('mediadc', 'Task errors') }}</h3>\n\t\t\t\t<div v-for=\"error in task.errors.split('\\\\n')\" :key=\"error\" class=\"error-row\">\n\t\t\t\t\t{{ error }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport axios from '@nextcloud/axios'\nimport { mapGetters } from 'vuex'\nimport Formats from '../mixins/Formats'\nimport { generateUrl } from '@nextcloud/router'\nimport DetailsList from '../components/details/DetailsList'\nimport { showSuccess, showError, showWarning } from '@nextcloud/dialogs'\nimport Configure from '../mixins/Configure'\nimport { getCurrentUser } from '@nextcloud/auth'\n\nexport default {\n\tname: 'CollectorDetails',\n\tcomponents: {\n\t\tDetailsList,\n\t},\n\tmixins: [\n\t\tFormats,\n\t\tConfigure,\n\t],\n\tprops: {\n\t\trootTitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tloading: {\n\t\t\ttype: Boolean,\n\t\t\trequired: true,\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tupdater: null,\n\t\t\tstatsUpdater: null,\n\t\t\tfilessize: 0,\n\t\t\tfilestotal: 0,\n\t\t\tactionsOpened: false,\n\t\t\tcollapsedStatus: false,\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapGetters([\n\t\t\t'task',\n\t\t\t'taskInfo',\n\t\t\t'details',\n\t\t\t'settingByName',\n\t\t]),\n\t\tisValidUser() {\n\t\t\treturn getCurrentUser().uid === this.task.owner\n\t\t},\n\t},\n\tbeforeMount() {\n\t\tthis.$emit('update:loading', true)\n\t\tthis.getTaskDetails()\n\t\tthis.getTaskInfo()\n\t\tthis.updater = setInterval(this.getTaskDetails, 5000)\n\t},\n\tbeforeDestroy() {\n\t\tclearInterval(this.updater)\n\t},\n\tmethods: {\n\t\tterminateTask(task) {\n\t\t\tthis.toggleActionsPopup()\n\t\t\tif (this.isValidUser) {\n\t\t\t\tthis.terminating = true\n\t\t\t\taxios.post(generateUrl(`/apps/mediadc/api/v1/tasks/${task.id}/terminate`)).then(res => {\n\t\t\t\t\tshowSuccess(t('mediadc', 'Task terminated'))\n\t\t\t\t\tthis.terminating = false\n\t\t\t\t\tthis.getTaskDetails()\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'You are not allowed to terminate this task'))\n\t\t\t}\n\t\t},\n\t\trestartTask(task) {\n\t\t\tthis.toggleActionsPopup()\n\t\t\tif (this.isValidUser) {\n\t\t\t\tthis.restarting = true\n\t\t\t\tthis.getSettings()\n\t\t\t\taxios.post(generateUrl('/apps/mediadc/api/v1/tasks/restart'), {\n\t\t\t\t\ttaskId: task.id,\n\t\t\t\t\ttargetDirectoryIds: task.target_directory_ids,\n\t\t\t\t\texcludeList: {\n\t\t\t\t\t\tuser: JSON.parse(task.exclude_list).user,\n\t\t\t\t\t\tadmin: JSON.parse(this.settingByName('exclude_list').value),\n\t\t\t\t\t},\n\t\t\t\t\tcollectorSettings: JSON.parse(task.collector_settings),\n\t\t\t\t}).then(res => {\n\t\t\t\t\tthis.restarting = false\n\t\t\t\t\tif (res.data.success) {\n\t\t\t\t\t\tshowSuccess(t('mediadc', 'Task successfully restarted with previous settings!'))\n\t\t\t\t\t\tthis.getTaskDetails()\n\t\t\t\t\t\tthis.filessize = 0\n\t\t\t\t\t\tthis.filestotal = 0\n\t\t\t\t\t} else {\n\t\t\t\t\t\tshowError('Some error occured while restarting Collector Task. Try again.')\n\t\t\t\t\t}\n\t\t\t\t}).catch(err => {\n\t\t\t\t\tthis.restarting = false\n\t\t\t\t\tconsole.debug(err)\n\t\t\t\t\tshowError('Some error occured while running Collector Task. Try again.')\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'You are not allowed to restart this task'))\n\t\t\t}\n\t\t},\n\t\tdeleteTask(task) {\n\t\t\tthis.toggleActionsPopup()\n\t\t\tif (this.isValidUser) {\n\t\t\t\tif (confirm(t('mediadc', 'Are sure, you want delete this task?'))) {\n\t\t\t\t\tthis.deleting = true\n\t\t\t\t\taxios.delete(generateUrl(`/apps/mediadc/api/v1/tasks/${task.id}`)).then(res => {\n\t\t\t\t\t\tthis.$router.push({ name: 'collector' })\n\t\t\t\t\t\tshowSuccess(t('mediadc', 'Task successfully deleted'))\n\t\t\t\t\t\tthis.deleting = false\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tshowWarning(t('mediadc', 'You are not allowed to delete this task'))\n\t\t\t}\n\t\t},\n\t\tasync getTaskDetails() {\n\t\t\taxios.get(generateUrl(`/apps/mediadc/api/v1/tasks/${this.$route.params.taskId}`)).then(res => {\n\t\t\t\tif ('success' in res.data && res.data.success) {\n\t\t\t\t\tthis.$store.dispatch('setTask', res.data.collectorTask)\n\t\t\t\t\tthis.$store.dispatch('setDetails', res.data.collectorTaskDetails)\n\t\t\t\t\tif (this.getStatusBadge(this.task) === 'finished'\n\t\t\t\t\t\t&& this.filestotal === 0 && this.filessize === 0) {\n\t\t\t\t\t\tthis.getDetailFilesTotalSize()\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis.$emit('update:loading', false)\n\t\t\t})\n\t\t},\n\t\tasync getTaskInfo() {\n\t\t\taxios.get(generateUrl(`/apps/mediadc/api/v1/tasks/${this.$route.params.taskId}/info`)).then(res => {\n\t\t\t\tthis.$store.dispatch('setTaskInfo', res.data.collectorTaskInfo)\n\t\t\t})\n\t\t},\n\t\tasync getDetailFilesTotalSize() {\n\t\t\taxios.get(generateUrl(`/apps/mediadc/api/v1/tasks/${this.$route.params.taskId}/filestotal`)).then(res => {\n\t\t\t\tthis.filessize = res.data.filessize\n\t\t\t\tthis.filestotal = res.data.filestotal\n\t\t\t})\n\t\t},\n\t\topenActionsPopup() {\n\t\t\tdocument.addEventListener('click', this.toggleActionsPopup)\n\t\t},\n\t\ttoggleActionsPopup() {\n\t\t\tif (this.actionsOpened) {\n\t\t\t\tdocument.removeEventListener('click', this.toggleActionsPopup)\n\t\t\t}\n\t\t\tthis.actionsOpened = !this.actionsOpened\n\t\t},\n\t\tcollapseTaskStatus() {\n\t\t\tthis.collapsedStatus = !this.collapsedStatus\n\t\t},\n\t},\n}\n<\/script>\n\n<style scoped>\n.container {\n\tpadding: 0 20px;\n\twidth: 100%;\n\tmax-width: 1440px;\n\tmargin: 0 auto;\n\tmax-height: 100%;\n}\n\nh2 {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tjustify-content: center;\n\twidth: 100%;\n\tmargin: 20px auto;\n\ttext-align: center;\n}\n\n.collapse-task-status-btn {\n\tdisplay: inline-flex;\n\tcursor: pointer;\n\twidth: 16px;\n\theight: 16px;\n\tmargin: 0 10px;\n\tpadding: 20px;\n\tborder-radius: 50%;\n\tuser-select: none;\n}\n\n.task-details-heading p {\n\ttext-align: center;\n}\n\n.details-row {\n\tdisplay: flex;\n\tmargin: 0 10px 20px;\n}\n\n@media (max-width: 767px) {\n\t.details-row {\n\t\tflex-wrap: wrap;\n\t}\n\t.task-details-heading {\n\t\tflex-direction: column;\n\t}\n}\n\n.task-status-row {\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n\tflex-wrap: wrap;\n}\n\n.task-status {\n\tdisplay: inline-flex;\n\talign-items: center;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tmargin: 20px;\n\tpadding: 10px;\n}\n\n.actions-menu-button {\n\tpadding: 20px;\n\tborder-radius: 50%;\n\tcursor: pointer;\n\tuser-select: none;\n}\n\n.actions-menu-button:hover, .collapse-task-status-btn:hover {\n\tbackground-color: #eee;\n}\n\n.actions-menu-button:active, .collapse-task-status-btn:active {\n\tbackground-color: #ddd;\n}\n\nbody.theme--dark .actions-menu-button:hover, body.theme--dark .collapse-task-status-btn:hover {\n\tbackground-color: #727272;\n}\n\nbody.theme--dark .actions-menu-button:active, body.theme--dark .collapse-task-status-btn:active {\n\tbackground-color: #5b5b5b;\n}\n\nbody.theme--dark .task-status, body.theme--dark .task-info {\n\tborder-color: #717171;\n}\n\n.task-owner {\n\tcolor: #585858;\n}\n\nbody.theme--dark .task-owner {\n\tcolor: #a9a8a8;\n}\n\n.task-info {\n\tmargin: 20px 0;\n\tborder: 1px solid #dadada;\n\tborder-radius: 5px;\n\tpadding: 10px 20px;\n\theight: 100%;\n\tmax-height: 94px;\n\tmax-width: 300px;\n\toverflow-y: scroll;\n}\n\n@media (max-width: 767px) {\n\t.task-status {\n\t\tflex-direction: column;\n\t}\n\n\t.task-info {\n\t\tmax-width: 100%;\n\t\tmargin: 0;\n\t}\n}\n\n.task-info h3 {\n\tmargin: 0 0 5px 0;\n}\n\n.target-directory-row {\n\toverflow-x: scroll;\n\twhite-space: nowrap;\n}\n\n.badge {\n\tdisplay: inline-flex;\n\tpadding: 0 10px;\n\tbackground-color: #eee;\n\tborder-radius: 20px;\n\tmargin-right: 20px;\n}\n\n@media (max-width: 540px) {\n\t.task-status-row {\n\t\tflex-direction: column;\n\t\tmargin: 20px 0;\n\t}\n\n\t.badge {\n\t\tmargin-right: 0;\n\t\tmargin-top: 10px;\n\t\tmargin-bottom: 10px;\n\t}\n}\n\n.badge.finished {\n\tbackground-color: #49b382;\n\tcolor: #fff;\n}\n\n.badge.running, .badge.pending {\n\tbackground-color: #dadada;\n\tcolor: #000;\n}\n\n.badge.error {\n\tbackground-color: #bd3f3f;\n\tcolor: #fff;\n}\n\n.badge.terminated {\n\tbackground-color: #f17b1b;\n\tcolor: #fff;\n}\n\n.errors {\n\tmargin: 20px;\n\tborder: 1px solid #bd3f3f;\n\tborder-radius: 5px;\n\tpadding: 10px;\n\tmax-height: 100vh;\n\toverflow-y: scroll;\n}\n\n.error-row {\n\tborder-bottom: 1px solid #bd3f3f;\n\tpadding: 5px 0;\n\tmax-height: 100%;\n\toverflow-y: scroll;\n}\n</style>\n"],sourceRoot:""}]),e.a=a},462:function(e,n,i){"use strict";i.r(n);var a=i(22),s=i.n(a),r=i(194),o=i(242),l=i(12),d=i(18),A=i(21);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function p(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var f={name:"DetailsFile",props:{file:{type:Object,required:!0},files:{type:Array,required:!0}},data:function(){return{loaded:!1}},computed:p({imageUrl:function(){return Object(l.generateRemoteUrl)("dav/files".concat(this.file.filepath.replace("files/","")))}},Object(r.c)(["detailsGridSize"])),methods:{openFile:function(t){var e=this.files.map((function(t){return{basename:t.filename,fileid:t.fileid,filename:t.filepath.replace("/".concat(Object(A.getCurrentUser)().uid,"/files"),""),getcontentlength:t.filesize,getcontenttype:t.filemtype,mime:t.filemtype,size:t.filesize}}));OCA.Viewer.open({path:t.filepath.replace("/".concat(Object(A.getCurrentUser)().uid,"/files"),""),list:e.map((function(t){return p(p({},t),{},{list:e})}))})},onLoad:function(){console.debug("[DetailsFile] loaded"),this.loaded=!0}}},h=i(65),m=i.n(h),g=i(457),b={insert:"head",singleton:!1},v=(m()(g.a,b),g.a.locals,i(67));function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function k(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var x={name:"DetailsGroupList",components:{DetailsFile:Object(v.a)(f,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"file-thumb",on:{click:function(e){return t.openFile(t.file)}}},[n("img",{directives:[{name:"show",rawName:"v-show",value:t.loaded,expression:"loaded"}],key:t.file.filepath,attrs:{src:t.imageUrl,alt:t.file.filename,title:t.file.filepath},on:{load:t.onLoad}}),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.loaded&&"video"===t.file.filempart,expression:"!loaded && file.filempart === 'video'"}],staticClass:"placeholder",style:"min-height: "+t.detailsGridSize+"px",attrs:{title:t.file.filepath}},[n("svg",{attrs:{width:"50%",height:"50%",version:"1.1",viewBox:"-31 0 512 512",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"m440.59 206.68h-341.17l327.7-94.93c2.5469-0.73828 4.6953-2.4609 5.9766-4.7812 1.2812-2.3242 1.5859-5.0586 0.84766-7.6055l-17.148-59.199c-6.8516-23.645-28.867-40.16-53.539-40.16-5.1992 0-10.379 0.73828-15.402 2.1914l-307.68 89.129c-14.23 4.1211-26.023 13.582-33.215 26.633-7.1875 13.051-8.875 28.078-4.7539 42.305l16.754 57.836v238.25c0 30.688 24.965 55.652 55.648 55.652h120.16c5.5234 0 10-4.4766 10-10s-4.4766-10-10-10h-120.16c-19.66 0-35.652-15.992-35.652-35.652v-136.09h391.63v136.09c2.1e-4 19.66-15.992 35.652-35.652 35.652h-120.16c-5.5195 0-10 4.4766-10 10s4.4805 10 10 10h120.16c30.688 0 55.652-24.965 55.652-55.652v-239.67c0-5.5234-4.4766-10-10-10zm-176.33 93.586 42.488-73.586h55.262l-42.484 73.586zm-78.359 0 42.488-73.586h55.262l-42.484 73.586zm-78.355 0 42.484-73.586h55.266l-42.488 73.586zm37.18-129.46-71.148-68.336 53.309-15.441c0.375 0.54688 0.8125 1.0625 1.3125 1.543l71.148 68.336-53.309 15.441c-0.375-0.54688-0.81641-1.0664-1.3125-1.543zm134-125.84 71.148 68.336-53.309 15.441c-0.375-0.54688-0.8125-1.0664-1.3125-1.543l-71.148-68.336 53.309-15.441c0.375 0.54688 0.8125 1.0625 1.3125 1.543zm-75.266 21.805 71.148 68.332-53.309 15.445c-0.375-0.54687-0.8125-1.0664-1.3125-1.543l-71.148-68.336 53.309-15.441c0.37891 0.54297 0.81641 1.0625 1.3125 1.543zm149.96-45.367c3.2109-0.92969 6.5195-1.4023 9.8359-1.4023 15.824 0 29.938 10.578 34.328 25.727l14.367 49.59-40.121 11.621c-0.3789-0.54688-0.8164-1.0625-1.3164-1.543l-71.145-68.332zm-328.94 106.2c4.6094-8.3711 12.16-14.434 21.262-17.07l5.875-1.7031c0.37891 0.54688 0.81641 1.0664 1.3125 1.543l71.148 68.336-88.293 25.578-14.367-49.59c-2.6367-9.0976-1.5469-18.719 3.0625-27.094zm14.48 99.074h87.973l-42.484 73.586h-45.488zm303.66 73.586 42.484-73.586h45.488v73.586z"}}),t._v(" "),n("path",{attrs:{d:"m303.92 405.11c0-3.5742-1.9062-6.875-5-8.6602l-87.855-50.723c-3.0938-1.7852-6.9062-1.7852-10 0-3.0938 1.7852-5 5.0859-5 8.6602v101.45c0 3.5703 1.9062 6.8711 5 8.6562 1.5469 0.89453 3.2734 1.3438 5 1.3438 1.7266 0 3.4531-0.44922 5-1.3438l87.855-50.719c3.0938-1.7852 5-5.0859 5-8.6602zm-87.855 33.402v-66.805l57.855 33.402z"}}),t._v(" "),n("path",{attrs:{d:"m234.77 492c-5.5078 0-10 4.4922-10 10s4.4922 10 10 10c5.5117 0 10-4.4922 10-10s-4.4883-10-10-10z"}})])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.loaded&&"image"===t.file.filempart,expression:"!loaded && file.filempart === 'image'"}],staticClass:"placeholder",style:"min-height: "+t.detailsGridSize+"px"},[n("svg",{attrs:{width:"50%","enable-background":"new 0 0 512 512",version:"1.1",viewBox:"0 0 512 512","xml:space":"preserve",xmlns:"http://www.w3.org/2000/svg"}},[n("path",{attrs:{d:"m446.58 0h-381.15c-36.076 0-65.425 29.35-65.425 65.426v381.15c0 36.075 29.349 65.425 65.425 65.425h381.15c36.076 0 65.425-29.35 65.425-65.426v-381.15c0-36.076-29.349-65.426-65.425-65.426zm35.267 446.58c0 19.447-15.821 35.267-35.267 35.267h-381.15c-19.447 0-35.268-15.821-35.268-35.267v-55.007l99.255-84.451c3.622-3.082 8.906-3.111 12.562-0.075l62.174 51.628c5.995 4.977 14.795 4.569 20.304-0.946l147.73-147.95c2.67-2.675 5.783-2.935 7.408-2.852 1.62 0.083 4.695 0.661 7.078 3.596l95.176 117.19v118.87zm0-166.71-71.766-88.366c-7.117-8.764-17.666-14.122-28.942-14.701-11.268-0.57-22.317 3.672-30.294 11.662l-138.01 138.22-51.59-42.839c-14.959-12.422-36.563-12.293-51.373 0.308l-79.712 67.822v-286.55c0-19.447 15.821-35.268 35.268-35.268h381.15c19.447 0 35.267 15.821 35.267 35.268v214.44z"}}),t._v(" "),n("path",{attrs:{d:"m161.17 62.995c-40.095 0-72.713 32.62-72.713 72.713 0 40.094 32.619 72.713 72.713 72.713s72.713-32.619 72.713-72.713-32.618-72.713-72.713-72.713zm0 115.27c-23.466 0-42.556-19.091-42.556-42.556 0-23.466 19.09-42.556 42.556-42.556s42.556 19.091 42.556 42.556-19.09 42.556-42.556 42.556z"}})])])])}),[],!1,null,"3b2be3bc",null).exports},mixins:[o.a],props:{files:{type:Array,required:!0},loadingFiles:{type:Boolean,required:!0}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(Object(n),!0).forEach((function(e){k(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(r.c)(["detailsGridSize"])),methods:{deleteGroupFile:function(e){var n=this;confirm(t("mediadc","Are you sure, you want delete this file?"))&&s.a.delete(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(e.taskId,"/files/").concat(e.detailId,"/").concat(e.fileid))).then((function(t){var i=n.files,a=i.findIndex((function(t){return t.fileid===e.fileid}));i.splice(a,1),n.$emit("update:files",i),n.$store.dispatch("setTask",t.data.task)}))}}},y=i(458),w={insert:"head",singleton:!1};m()(y.a,w),y.a.locals;function j(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function _(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?j(Object(n),!0).forEach((function(e){O(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function O(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var B={name:"DetailsListItem",components:{DetailsGroupList:Object(v.a)(x,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loadingFiles?n("div",[n("span",{staticClass:"icon-loading",staticStyle:{width:"20px",height:"20px",display:"flex",margin:"20px auto"}})]):n("div",{staticClass:"details-group"},[n("div",{staticClass:"details-group-files"},t._l(t.files,(function(e){return n("div",{key:e.fileid,staticClass:"file",style:"width: "+t.detailsGridSize+"px; min-height: "+t.detailsGridSize+"px;"},[n("DetailsFile",{attrs:{file:e,files:t.files}}),t._v(" "),n("div",{staticClass:"file-info"},[n("span",{staticClass:"filename"},[t._v(t._s(e.filename))]),t._v(" "),n("span",{staticClass:"owner"},[t._v(t._s(e.fileowner))]),t._v(" "),n("span",{staticClass:"size"},[t._v(t._s(t.formatBytes(Number(e.filesize))))]),t._v(" "),n("span",{staticClass:"delete-file-btn icon-delete-white",on:{click:function(n){return t.deleteGroupFile(e)}}})])],1)})),0)])}),[],!1,null,"b0be6cc8",null).exports},mixins:[o.a],props:{detail:{type:Object,required:!0}},data:function(){return{opened:!1,page:0,totalPages:0,itemsPerPage:10,loadingFiles:!1,files:[],paginatedFiles:{}}},computed:_({},Object(r.c)(["task","details"])),methods:{openDetailFiles:function(t){if(this.opened)this.opened=!1;else if(0===this.files.length){var e=t.task_id,n=t.id;this.loadingFiles=!0,this.opened=!0,this.page in this.paginatedFiles?(this.files=this.paginatedFiles[this.page],this.loadingFiles=!1):this.loadFilesInfo(e,n)}else this.opened=!0},openNextDetailFiles:function(e){if(this.page<Math.ceil(JSON.parse(e.group_file_ids).length/this.itemsPerPage)-1){this.page+=1;var n=e.task_id,i=e.id;this.loadingFiles=!0,this.page in this.paginatedFiles?(this.files=this.paginatedFiles[this.page],this.loadingFiles=!1):this.loadFilesInfo(n,i)}else Object(d.d)(t("mediadc","Last page reached!"))},openPrevDetailFiles:function(e){if(this.page>0){this.page-=1;var n=e.task_id,i=e.id;this.loadingFiles=!0,this.page in this.paginatedFiles?(this.files=this.paginatedFiles[this.page],this.loadingFiles=!1):this.loadFilesInfo(n,i)}else Object(d.d)(t("mediadc","First page reached!"))},loadFilesInfo:function(t,e){var n=this;s.a.get(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(t,"/files/").concat(e,"?limit=").concat(this.itemsPerPage,"&page=").concat(this.page))).then((function(i){n.paginatedFiles[n.page]=i.data.map((function(n){return _(_({},n),{},{taskId:t,detailId:e})})),n.files=n.paginatedFiles[n.page],n.loadingFiles=!1}))},getGroupFilesSize:function(t){return t.reduce((function(t,e){return t+e.filesize}),0)},deleteTaskDetail:function(e){var n=this;confirm(t("mediadc","Are you sure, you want remove this group without deleting files?"))&&s.a.delete(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(e.task_id,"/detail/").concat(e.id))).then((function(i){i.data.success?(n.$store.dispatch("deleteDetail",e),Object(d.c)(t("mediadc","Duplicate group succesffully removed"))):Object(d.b)(t("mediadc","Some error occured while deleting duplicate group"))}))}}},P=i(459),T={insert:"head",singleton:!1};m()(P.a,T),P.a.locals;function F(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function S(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var D={name:"DetailsList",components:{DetailsListItem:Object(v.a)(B,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"details-list-item"},[n("div",{staticClass:"details-list-item-title"},[n("span",{staticClass:"icon-projects",staticStyle:{margin:"0 5px 0 0"}}),t._v(" "),n("span",{staticClass:"group-info",on:{click:function(e){return t.openDetailFiles(t.detail)}}},[t._v("\n\t\t\t"+t._s(t.t("mediadc","Duplicate group"))+" #"+t._s(t.detail.id)+" ("+t._s(JSON.parse(t.detail.group_file_ids).length)+"\n\t\t\t"+t._s(t.t("mediadc","file(s)"))+t._s(t.files.length>0?" - "+t.formatBytes(t.getGroupFilesSize(t.files)):"")+")\n\t\t")]),t._v(" "),n("span",{class:t.opened?"icon-triangle-n open-details-btn":"icon-triangle-s open-details-btn"}),t._v(" "),n("span",{staticClass:"icon-delete delete-group-btn",on:{click:function(e){return t.deleteTaskDetail(t.detail)}}})]),t._v(" "),t.opened&&JSON.parse(t.detail.group_file_ids).length>t.itemsPerPage?n("div",{staticClass:"pagination"},[n("span",{staticClass:"icon-view-previous pagination-button",on:{click:function(e){return t.openPrevDetailFiles(t.detail)}}}),t._v(" "),n("span",[t._v(t._s(t.t("mediadc","Page:"))+" ")]),t._v(" "),n("span",[t._v(t._s(t.page+1)+"/"+t._s(Math.ceil(JSON.parse(t.detail.group_file_ids).length/t.itemsPerPage)))]),t._v(" "),n("span",{staticClass:"icon-view-next pagination-button",on:{click:function(e){return t.openNextDetailFiles(t.detail)}}})]):t._e(),t._v(" "),n("DetailsGroupList",{directives:[{name:"show",rawName:"v-show",value:t.opened,expression:"opened"}],attrs:{files:t.files,"loading-files":t.loadingFiles}})],1)}),[],!1,null,"4156cb36",null).exports},mixins:[o.a],props:{filessize:{type:Number,required:!0},filestotal:{type:Number,required:!0}},data:function(){return{page:0}},computed:function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?F(Object(n),!0).forEach((function(e){S(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},Object(r.c)(["task","details","paginatedDetails","itemsPerPage"])),beforeMount:function(){this.$emit("update:loading",!1)},methods:{prevGroupsPage:function(){this.page>0?this.page-=1:Object(d.d)(t("mediadc","First page reached!"))},nextGroupsPage:function(){this.page<Math.ceil(this.details.length/this.itemsPerPage)-1?this.page+=1:Object(d.d)(t("mediadc","Last page reached!"))}}},E=i(460),z={insert:"head",singleton:!1},I=(m()(E.a,z),E.a.locals,Object(v.a)(D,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"task-details"},[n("div",{staticClass:"task-details-heading"},[n("h3",[t._v("\n\t\t\t"+t._s(t.t("mediadc","Duplicates list"))+"\n\t\t\t"),"finished"===t.getStatusBadge(t.task)?n("span",[t._v("\n\t\t\t\t- "+t._s(t.details.length)+" "+t._s(t.t("mediadc","group(s)"))+"\n\t\t\t\t("+t._s(t.filestotal)+" "+t._s(t.t("mediadc","file(s)"))+" - "+t._s(t.formatBytes(t.filessize))+")\n\t\t\t")]):t._e()]),t._v(" "),t.details.length>t.itemsPerPage?n("div",{staticClass:"pagination"},[n("span",{staticClass:"icon-view-previous pagination-button",on:{click:function(e){return t.prevGroupsPage()}}}),t._v(" "),n("span",[t._v(t._s(t.t("mediadc","Page:"))+" ")]),t._v(" "),n("span",[t._v(t._s(t.page+1)+"/"+t._s(Math.ceil(t.details.length/t.itemsPerPage)))]),t._v(" "),n("span",{staticClass:"icon-view-next pagination-button",on:{click:function(e){return t.nextGroupsPage()}}})]):t._e()]),t._v(" "),t.details.length>0?n("div",t._l(t.paginatedDetails[t.page],(function(t){return n("div",{directives:[{name:"show",rawName:"v-show",value:JSON.parse(t.group_file_ids).length>1,expression:"JSON.parse(detail.group_file_ids).length > 1"}],key:t.id,staticClass:"task-details-row"},[n("DetailsListItem",{attrs:{detail:t}})],1)})),0):n("div",[n("strong",[t._v(t._s(t.t("mediadc","No duplicates found.")))])])])}),[],!1,null,"5a5d6470",null).exports),N=i(379);function U(t,e,n,i,a,s,r){try{var o=t[s](r),l=o.value}catch(t){return void n(t)}o.done?e(l):Promise.resolve(l).then(i,a)}function G(t){return function(){var e=this,n=arguments;return new Promise((function(i,a){var s=t.apply(e,n);function r(t){U(s,i,a,r,o,"next",t)}function o(t){U(s,i,a,r,o,"throw",t)}r(void 0)}))}}function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function R(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){$(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function $(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Y={name:"CollectorDetails",components:{DetailsList:I},mixins:[o.a,N.a],props:{rootTitle:{type:String,required:!0},loading:{type:Boolean,required:!0}},data:function(){return{updater:null,statsUpdater:null,filessize:0,filestotal:0,actionsOpened:!1,collapsedStatus:!1}},computed:R(R({},Object(r.c)(["task","taskInfo","details","settingByName"])),{},{isValidUser:function(){return Object(A.getCurrentUser)().uid===this.task.owner}}),beforeMount:function(){this.$emit("update:loading",!0),this.getTaskDetails(),this.getTaskInfo(),this.updater=setInterval(this.getTaskDetails,5e3)},beforeDestroy:function(){clearInterval(this.updater)},methods:{terminateTask:function(e){var n=this;this.toggleActionsPopup(),this.isValidUser?(this.terminating=!0,s.a.post(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(e.id,"/terminate"))).then((function(e){Object(d.c)(t("mediadc","Task terminated")),n.terminating=!1,n.getTaskDetails()}))):Object(d.d)(t("mediadc","You are not allowed to terminate this task"))},restartTask:function(e){var n=this;this.toggleActionsPopup(),this.isValidUser?(this.restarting=!0,this.getSettings(),s.a.post(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/restart"),{taskId:e.id,targetDirectoryIds:e.target_directory_ids,excludeList:{user:JSON.parse(e.exclude_list).user,admin:JSON.parse(this.settingByName("exclude_list").value)},collectorSettings:JSON.parse(e.collector_settings)}).then((function(e){n.restarting=!1,e.data.success?(Object(d.c)(t("mediadc","Task successfully restarted with previous settings!")),n.getTaskDetails(),n.filessize=0,n.filestotal=0):Object(d.b)("Some error occured while restarting Collector Task. Try again.")})).catch((function(t){n.restarting=!1,console.debug(t),Object(d.b)("Some error occured while running Collector Task. Try again.")}))):Object(d.d)(t("mediadc","You are not allowed to restart this task"))},deleteTask:function(e){var n=this;this.toggleActionsPopup(),this.isValidUser?confirm(t("mediadc","Are sure, you want delete this task?"))&&(this.deleting=!0,s.a.delete(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(e.id))).then((function(e){n.$router.push({name:"collector"}),Object(d.c)(t("mediadc","Task successfully deleted")),n.deleting=!1}))):Object(d.d)(t("mediadc","You are not allowed to delete this task"))},getTaskDetails:function(){var t=this;return G(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.a.get(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(t.$route.params.taskId))).then((function(e){"success"in e.data&&e.data.success&&(t.$store.dispatch("setTask",e.data.collectorTask),t.$store.dispatch("setDetails",e.data.collectorTaskDetails),"finished"===t.getStatusBadge(t.task)&&0===t.filestotal&&0===t.filessize&&t.getDetailFilesTotalSize()),t.$emit("update:loading",!1)}));case 1:case"end":return e.stop()}}),e)})))()},getTaskInfo:function(){var t=this;return G(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.a.get(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(t.$route.params.taskId,"/info"))).then((function(e){t.$store.dispatch("setTaskInfo",e.data.collectorTaskInfo)}));case 1:case"end":return e.stop()}}),e)})))()},getDetailFilesTotalSize:function(){var t=this;return G(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:s.a.get(Object(l.generateUrl)("/apps/mediadc/api/v1/tasks/".concat(t.$route.params.taskId,"/filestotal"))).then((function(e){t.filessize=e.data.filessize,t.filestotal=e.data.filestotal}));case 1:case"end":return e.stop()}}),e)})))()},openActionsPopup:function(){document.addEventListener("click",this.toggleActionsPopup)},toggleActionsPopup:function(){this.actionsOpened&&document.removeEventListener("click",this.toggleActionsPopup),this.actionsOpened=!this.actionsOpened},collapseTaskStatus:function(){this.collapsedStatus=!this.collapsedStatus}}},W=i(461),M={insert:"head",singleton:!1},q=(m()(W.a,M),W.a.locals,Object(v.a)(Y,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.loading?t._e():n("div",{staticClass:"container"},[n("div",{staticClass:"task-details"},[n("div",{staticClass:"task-details-heading"},[n("h2",[t._v("\n\t\t\t\t"+t._s(t.rootTitle)+"\n\t\t\t\t"),n("span",{class:t.collapsedStatus?"icon-triangle-s collapse-task-status-btn":"icon-triangle-n collapse-task-status-btn",on:{click:t.collapseTaskStatus}})]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.collapsedStatus,expression:"!collapsedStatus"}],staticClass:"task-details-description"},[n("p",[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Here you can view task details, manage task (stop or restart), delete found duplicated photos and videos."))+"\n\t\t\t\t")]),t._v(" "),n("p",[t._v("\n\t\t\t\t\t"+t._s(t.t("mediadc","Deleted files are placed in the trash, so that they can be restored in case of need."))+"\n\t\t\t\t")])])]),t._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:!t.collapsedStatus,expression:"!collapsedStatus"}],staticClass:"task-status-row"},[n("div",{staticClass:"task-status"},[n("span",{class:"badge "+t.getStatusBadge(t.task)},[t._v(t._s(t.getStatusBadge(t.task)))]),t._v(" "),n("div",{staticStyle:{display:"flex","flex-direction":"column"}},[n("span",[n("b",[t._v(t._s(t.t("mediadc","Task #"))+t._s(t.parseTargetMtype(t.task)))]),t._v(" "+t._s(t.task.files_scanned!==t.task.files_total?t.task.files_scanned+"/":"")+t._s(t.task.files_total)+" file(s)\n\t\t\t\t\t\t("+t._s(t.formatBytes(Number(t.task.files_total_size)))+")\n\t\t\t\t\t\t"),n("br"),t._v(" "),n("b",[t._v(t._s(t.t("mediadc","Deleted: "))+" ")]),t._v("\n\t\t\t\t\t\t"+t._s(t.task.deleted_files_count)+" "+t._s(t.t("mediadc","file(s)"))+"\n\t\t\t\t\t\t("+t._s(t.formatBytes(Number(t.task.deleted_files_size)))+")\n\t\t\t\t\t")]),t._v(" "),n("span",[t._v("\n\t\t\t\t\t\t"+t._s(t.t("mediadc","by"))+" "),n("span",{staticClass:"task-owner"},[t._v(t._s(t.task.owner+" "))]),t._v("\n\t\t\t\t\t\t("+t._s(t.parseUnixTimestamp(t.task.created_time))+t._s(Number(t.task.finished_time)>0?" - "+t.parseUnixTimestamp(t.task.finished_time):"")+")\n\t\t\t\t\t")])]),t._v(" "),n("div",{staticClass:"app-content-list-menu",staticStyle:{margin:"0 0 0 10px",position:"relative"}},[n("div",{staticClass:"icon-more actions-menu-button",on:{click:t.openActionsPopup}}),t._v(" "),n("div",{class:t.actionsOpened?"popovermenu open":"popovermenu",staticStyle:{right:"-1px"}},[n("ul",[n("li",[n("a",{staticClass:"icon-history",on:{click:function(e){return t.restartTask(t.task)}}},[n("span",[t._v(t._s(t.t("mediadc","Restart")))])])]),t._v(" "),n("li",[n("a",{staticClass:"icon-pause",on:{click:function(e){return t.terminateTask(t.task)}}},[n("span",[t._v(t._s(t.t("mediadc","Stop")))])])]),t._v(" "),n("li",[n("a",{staticClass:"icon-delete",on:{click:function(e){return t.deleteTask(t.task)}}},[n("span",[t._v(t._s(t.t("mediadc","Delete")))])])])])])])]),t._v(" "),n("div",{staticClass:"task-info"},[n("h3",[t._v(t._s(t.t("mediadc","Target directories")))]),t._v(" "),n("div",{staticClass:"target-directories-list"},t._l(t.taskInfo,(function(e){return n("div",{key:e.fileid,staticClass:"target-directory-row"},[n("b",[t._v("["+t._s(e.fileowner)+"] "+t._s(e.filepath.replace("/admin/files","")))]),t._v(" ("+t._s(t.formatBytes(e.filesize))+")\n\t\t\t\t\t")])})),0)])]),t._v(" "),t.isValidUser?n("div",{staticClass:"details-row"},[n("DetailsList",{attrs:{filessize:t.filessize,filestotal:t.filestotal}})],1):n("div",[n("p",{staticStyle:{"text-align":"center"}},[n("b",[t._v(t._s(t.t("mediadc","You are not allowed to manage other user's tasks.")))])])]),t._v(" "),void 0!==t.task.errors&&t.task.errors.length>0?n("div",{staticClass:"errors"},[n("h3",[t._v(t._s(t.t("mediadc","Task errors")))]),t._v(" "),t._l(t.task.errors.split("\\n"),(function(e){return n("div",{key:e,staticClass:"error-row"},[t._v("\n\t\t\t\t"+t._s(e)+"\n\t\t\t")])}))],2):t._e()])])}),[],!1,null,"7ead2322",null));n.default=q.exports}}]);
//# sourceMappingURL=mediadc-4.js.map?v=c2dba15f4d035a7d5c9e